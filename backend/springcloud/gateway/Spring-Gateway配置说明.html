<!DOCTYPE html>
<html lang="en-Zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.46">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/icon/favicon.ico"><meta name="application-name" content="MoomHub"><meta name="apple-mobile-web-app-title" content="MoomHub"><title>Spring Gateway 配置说明 | 青衣水袖</title><meta name="description" content="记录学习信息的文档">
    <link rel="modulepreload" href="/assets/app.4a9c1875.js"><link rel="modulepreload" href="/assets/Spring-Gateway配置说明.html.77da2095.js"><link rel="modulepreload" href="/assets/Spring-Gateway配置说明.html.317c443f.js"><link rel="prefetch" href="/assets/index.html.468fd202.js"><link rel="prefetch" href="/assets/随机数.html.e3d01a1e.js"><link rel="prefetch" href="/assets/TypeScript学习.html.6baf459a.js"><link rel="prefetch" href="/assets/Spring Boot 使用 Junit5测试.html.296e78aa.js"><link rel="prefetch" href="/assets/SpringBoot使用Log4j2日志框架.html.634eba63.js"><link rel="prefetch" href="/assets/SpringBoot多样化构建Docker.html.afab33b2.js"><link rel="prefetch" href="/assets/SpringBoot拦截器.html.84a45392.js"><link rel="prefetch" href="/assets/SpringBoot注解.html.c6e774de.js"><link rel="prefetch" href="/assets/SpringBoot项目Jar方式运行.html.f02763cf.js"><link rel="prefetch" href="/assets/helloworld.html.862da223.js"><link rel="prefetch" href="/assets/图形监控-Spring-Boot-Admin.html.ac745cbd.js"><link rel="prefetch" href="/assets/监控应用Spring-Boot-Actuator.html.a2cbd6f3.js"><link rel="prefetch" href="/assets/错误处理.html.bca399f9.js"><link rel="prefetch" href="/assets/MySql数据库相关概念.html.61316e19.js"><link rel="prefetch" href="/assets/Mysql查询优化-数据库优化.html.ddeac2f8.js"><link rel="prefetch" href="/assets/Mysql查询优化-语句优化.html.c1da6748.js"><link rel="prefetch" href="/assets/Mysql核心-索引.html.a83e5866.js"><link rel="prefetch" href="/assets/Mysql核心-视图.html.a1dbc1f1.js"><link rel="prefetch" href="/assets/Mysql项目-新零售数据库设计.html.1eb8a63b.js"><link rel="prefetch" href="/assets/Mysql项目-程序设计.html.f07fd66b.js"><link rel="prefetch" href="/assets/PerconaTookit工具.html.b175ecb8.js"><link rel="prefetch" href="/assets/mysql数据日志.html.f937338f.js"><link rel="prefetch" href="/assets/常用的Mysql命令.html.30719a11.js"><link rel="prefetch" href="/assets/数据库的备份和恢复.html.f4b612cc.js"><link rel="prefetch" href="/assets/MyCat学习.html.5fd1cd14.js"><link rel="prefetch" href="/assets/PXC集群主机安装.html.37e2d4fb.js"><link rel="prefetch" href="/assets/双主高可用实现负载均衡.html.17b55feb.js"><link rel="prefetch" href="/assets/安装Percona数据库.html.c588eae9.js"><link rel="prefetch" href="/assets/番外.html.9f5cb0f2.js"><link rel="prefetch" href="/assets/Java环境变量配置.html.d4a27ac2.js"><link rel="prefetch" href="/assets/Lambda表达式.html.dba2184e.js"><link rel="prefetch" href="/assets/垃圾回收GC.html.99b5409e.js"><link rel="prefetch" href="/assets/8-17新特性API.html.b23d9a9b.js"><link rel="prefetch" href="/assets/Java10新特性.html.97eb01e2.js"><link rel="prefetch" href="/assets/Java8新特性-Optional.html.37625146.js"><link rel="prefetch" href="/assets/Java8新特性-Stream流式编程.html.00d4be70.js"><link rel="prefetch" href="/assets/Java8新特性-时间类.html.2f925532.js"><link rel="prefetch" href="/assets/Java9新特性.html.bf8818e4.js"><link rel="prefetch" href="/assets/Java并发编程-AQS并发容器同步组件.html.51db2c96.js"><link rel="prefetch" href="/assets/Java线程池.html.ba5e7be1.js"><link rel="prefetch" href="/assets/实现线程的几种方式.html.fe2d808c.js"><link rel="prefetch" href="/assets/指令重排.html.d9439df1.js"><link rel="prefetch" href="/assets/等待唤醒机制.html.017bdafa.js"><link rel="prefetch" href="/assets/线程基本概念.html.757469c1.js"><link rel="prefetch" href="/assets/线程安全.html.e1b26214.js"><link rel="prefetch" href="/assets/线程的生命周期.html.5614bef2.js"><link rel="prefetch" href="/assets/Docker命令说明.html.beba32c0.js"><link rel="prefetch" href="/assets/Docker安装.html.b71e702f.js"><link rel="prefetch" href="/assets/Docker安装Mysql.html.ebbbd647.js"><link rel="prefetch" href="/assets/Docker安装Nacos.html.9f6940f1.js"><link rel="prefetch" href="/assets/Docker安装Web管理平台.html.b15dedb0.js"><link rel="prefetch" href="/assets/Docker运行设置IP.html.d446c915.js"><link rel="prefetch" href="/assets/Docker部署haproxy.html.56c21947.js"><link rel="prefetch" href="/assets/Doker安装Redis.html.2bee4f08.js"><link rel="prefetch" href="/assets/Linux定时脚本.html.3fe35291.js"><link rel="prefetch" href="/assets/Linux问题归档.html.50567e3a.js"><link rel="prefetch" href="/assets/Ubuntu设置国内镜像软件源.html.936fd155.js"><link rel="prefetch" href="/assets/Ubuntu设置远程登陆.html.1a5ecc31.js"><link rel="prefetch" href="/assets/PigGo_图床.html.ff155a0c.js"><link rel="prefetch" href="/assets/WSL2使用文档.html.957f3fb4.js"><link rel="prefetch" href="/assets/Windows使用WSL2.html.6d188cdf.js"><link rel="prefetch" href="/assets/Hystrixs-断路由使用.html.32554b19.js"><link rel="prefetch" href="/assets/Loadbalancer负载均衡.html.4d817f71.js"><link rel="prefetch" href="/assets/Ribbon负载均衡服务.html.edf330d3.js"><link rel="prefetch" href="/assets/服务调用OpenFeign.html.2c46cec0.js"><link rel="prefetch" href="/assets/Seata分布式事务.html.481e8b4b.js"><link rel="prefetch" href="/assets/Spring-Cloud-Stream消息驱动-消费异常处理机制.html.786b5aba.js"><link rel="prefetch" href="/assets/Spring-Cloud-Stream消息驱动消息过滤的三种方式.html.02cd38df.js"><link rel="prefetch" href="/assets/Spring-Cloud-Stream消息驱动配置.html.8238b711.js"><link rel="prefetch" href="/assets/Stream整合Rocketmq实现事务消息(三).html.8de1dfbb.js"><link rel="prefetch" href="/assets/Stream整合Rocketmq实现广播和顺序消息(一).html.c980ee80.js"><link rel="prefetch" href="/assets/Stream整合Rocketmq实现延时消息(二).html.1b9c9767.js"><link rel="prefetch" href="/assets/Sleuth和Zipkin.html.a2f0b365.js"><link rel="prefetch" href="/assets/DDL数据库定义语言.html.e7c3eb9e.js"><link rel="prefetch" href="/assets/DML数据处理之增删改.html.47561dd6.js"><link rel="prefetch" href="/assets/SQL练习-01.html.3b5af471.js"><link rel="prefetch" href="/assets/分组函数.html.8473766a.js"><link rel="prefetch" href="/assets/分组查询.html.4dd2e6ab.js"><link rel="prefetch" href="/assets/分页查询.html.d1a872b9.js"><link rel="prefetch" href="/assets/单行函数.html.49d51dd7.js"><link rel="prefetch" href="/assets/基本查询.html.4815160a.js"><link rel="prefetch" href="/assets/排序查询.html.2db265d0.js"><link rel="prefetch" href="/assets/数据事务.html.c916bb27.js"><link rel="prefetch" href="/assets/数据库和SQL概述.html.0f673c1a.js"><link rel="prefetch" href="/assets/条件查询.html.9cdf8def.js"><link rel="prefetch" href="/assets/联合查询.html.9917791e.js"><link rel="prefetch" href="/assets/连接查询.html.b22a4de2.js"><link rel="prefetch" href="/assets/404.html.01fa9517.js"><link rel="prefetch" href="/assets/index.html.5836dbf6.js"><link rel="prefetch" href="/assets/随机数.html.3a815f5c.js"><link rel="prefetch" href="/assets/TypeScript学习.html.adbd8f1d.js"><link rel="prefetch" href="/assets/Spring Boot 使用 Junit5测试.html.e12cb97d.js"><link rel="prefetch" href="/assets/SpringBoot使用Log4j2日志框架.html.ec9f8897.js"><link rel="prefetch" href="/assets/SpringBoot多样化构建Docker.html.758e3dcb.js"><link rel="prefetch" href="/assets/SpringBoot拦截器.html.321a2949.js"><link rel="prefetch" href="/assets/SpringBoot注解.html.8ca4a871.js"><link rel="prefetch" href="/assets/SpringBoot项目Jar方式运行.html.ab0a01da.js"><link rel="prefetch" href="/assets/helloworld.html.44762b40.js"><link rel="prefetch" href="/assets/图形监控-Spring-Boot-Admin.html.8d4ca6ca.js"><link rel="prefetch" href="/assets/监控应用Spring-Boot-Actuator.html.5a40f374.js"><link rel="prefetch" href="/assets/错误处理.html.ab07afd8.js"><link rel="prefetch" href="/assets/MySql数据库相关概念.html.3b9e3bf3.js"><link rel="prefetch" href="/assets/Mysql查询优化-数据库优化.html.a6bbc83b.js"><link rel="prefetch" href="/assets/Mysql查询优化-语句优化.html.7d093d44.js"><link rel="prefetch" href="/assets/Mysql核心-索引.html.577b06a8.js"><link rel="prefetch" href="/assets/Mysql核心-视图.html.ec7b22f4.js"><link rel="prefetch" href="/assets/Mysql项目-新零售数据库设计.html.0307ce1d.js"><link rel="prefetch" href="/assets/Mysql项目-程序设计.html.d9827e01.js"><link rel="prefetch" href="/assets/PerconaTookit工具.html.1d426870.js"><link rel="prefetch" href="/assets/mysql数据日志.html.d62edff2.js"><link rel="prefetch" href="/assets/常用的Mysql命令.html.573bd433.js"><link rel="prefetch" href="/assets/数据库的备份和恢复.html.7574270e.js"><link rel="prefetch" href="/assets/MyCat学习.html.a4f01480.js"><link rel="prefetch" href="/assets/PXC集群主机安装.html.04a9ffe0.js"><link rel="prefetch" href="/assets/双主高可用实现负载均衡.html.e603c3de.js"><link rel="prefetch" href="/assets/安装Percona数据库.html.7d1d9ea9.js"><link rel="prefetch" href="/assets/番外.html.4669ca30.js"><link rel="prefetch" href="/assets/Java环境变量配置.html.94200dd4.js"><link rel="prefetch" href="/assets/Lambda表达式.html.e86ff6e4.js"><link rel="prefetch" href="/assets/垃圾回收GC.html.39db3df8.js"><link rel="prefetch" href="/assets/8-17新特性API.html.11150ca2.js"><link rel="prefetch" href="/assets/Java10新特性.html.5da7d147.js"><link rel="prefetch" href="/assets/Java8新特性-Optional.html.ea2715a6.js"><link rel="prefetch" href="/assets/Java8新特性-Stream流式编程.html.ab89bcd5.js"><link rel="prefetch" href="/assets/Java8新特性-时间类.html.a0f829e5.js"><link rel="prefetch" href="/assets/Java9新特性.html.bcbd2596.js"><link rel="prefetch" href="/assets/Java并发编程-AQS并发容器同步组件.html.28d60a64.js"><link rel="prefetch" href="/assets/Java线程池.html.9a838964.js"><link rel="prefetch" href="/assets/实现线程的几种方式.html.6d97db33.js"><link rel="prefetch" href="/assets/指令重排.html.c0f655d4.js"><link rel="prefetch" href="/assets/等待唤醒机制.html.32bee595.js"><link rel="prefetch" href="/assets/线程基本概念.html.285fe513.js"><link rel="prefetch" href="/assets/线程安全.html.9e70119f.js"><link rel="prefetch" href="/assets/线程的生命周期.html.54b9a36a.js"><link rel="prefetch" href="/assets/Docker命令说明.html.10a35eb1.js"><link rel="prefetch" href="/assets/Docker安装.html.9b72fbaf.js"><link rel="prefetch" href="/assets/Docker安装Mysql.html.8e9dcc3d.js"><link rel="prefetch" href="/assets/Docker安装Nacos.html.0c7066c8.js"><link rel="prefetch" href="/assets/Docker安装Web管理平台.html.16b66a1e.js"><link rel="prefetch" href="/assets/Docker运行设置IP.html.e399fc36.js"><link rel="prefetch" href="/assets/Docker部署haproxy.html.30c338c9.js"><link rel="prefetch" href="/assets/Doker安装Redis.html.e01811d9.js"><link rel="prefetch" href="/assets/Linux定时脚本.html.0773130e.js"><link rel="prefetch" href="/assets/Linux问题归档.html.836078cf.js"><link rel="prefetch" href="/assets/Ubuntu设置国内镜像软件源.html.36089e7f.js"><link rel="prefetch" href="/assets/Ubuntu设置远程登陆.html.989392fb.js"><link rel="prefetch" href="/assets/PigGo_图床.html.7c94cd32.js"><link rel="prefetch" href="/assets/WSL2使用文档.html.17f7d9b8.js"><link rel="prefetch" href="/assets/Windows使用WSL2.html.6a552282.js"><link rel="prefetch" href="/assets/Hystrixs-断路由使用.html.e43be0b5.js"><link rel="prefetch" href="/assets/Loadbalancer负载均衡.html.3a0a3ad7.js"><link rel="prefetch" href="/assets/Ribbon负载均衡服务.html.7d2b1290.js"><link rel="prefetch" href="/assets/服务调用OpenFeign.html.937ef2d2.js"><link rel="prefetch" href="/assets/Seata分布式事务.html.c4acbc31.js"><link rel="prefetch" href="/assets/Spring-Cloud-Stream消息驱动-消费异常处理机制.html.6aa10f8f.js"><link rel="prefetch" href="/assets/Spring-Cloud-Stream消息驱动消息过滤的三种方式.html.419c75d5.js"><link rel="prefetch" href="/assets/Spring-Cloud-Stream消息驱动配置.html.82681e2a.js"><link rel="prefetch" href="/assets/Stream整合Rocketmq实现事务消息(三).html.9f32a439.js"><link rel="prefetch" href="/assets/Stream整合Rocketmq实现广播和顺序消息(一).html.cd050fc9.js"><link rel="prefetch" href="/assets/Stream整合Rocketmq实现延时消息(二).html.bf43339a.js"><link rel="prefetch" href="/assets/Sleuth和Zipkin.html.1847a36b.js"><link rel="prefetch" href="/assets/DDL数据库定义语言.html.a1b0f725.js"><link rel="prefetch" href="/assets/DML数据处理之增删改.html.4cdfca73.js"><link rel="prefetch" href="/assets/SQL练习-01.html.77d68c39.js"><link rel="prefetch" href="/assets/分组函数.html.cb093a68.js"><link rel="prefetch" href="/assets/分组查询.html.d18eada3.js"><link rel="prefetch" href="/assets/分页查询.html.f56764e6.js"><link rel="prefetch" href="/assets/单行函数.html.deb9ae79.js"><link rel="prefetch" href="/assets/基本查询.html.8310c45c.js"><link rel="prefetch" href="/assets/排序查询.html.d998eca8.js"><link rel="prefetch" href="/assets/数据事务.html.ab27f45c.js"><link rel="prefetch" href="/assets/数据库和SQL概述.html.5ae239f0.js"><link rel="prefetch" href="/assets/条件查询.html.f14c61c1.js"><link rel="prefetch" href="/assets/联合查询.html.d8a5248d.js"><link rel="prefetch" href="/assets/连接查询.html.a0959fc2.js"><link rel="prefetch" href="/assets/404.html.9b9bf036.js"><link rel="prefetch" href="/assets/404.1cfa2fc0.js"><link rel="prefetch" href="/assets/Layout.ce6856c3.js">
    <link rel="stylesheet" href="/assets/style.811e635c.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/png/logo.png" alt="青衣水袖"><span class="site-name can-hide">青衣水袖</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/java/newApi/8-17新特性API.html" class="" aria-label="Java 版本特性"><!--[--><!--]--> Java 版本特性 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/java/base/Java环境变量配置.html" class="" aria-label="Java 基础"><!--[--><!--]--> Java 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/java/thread/线程基本概念.html" class="" aria-label="多线程"><!--[--><!--]--> 多线程 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="后端文档"><span class="title">后端文档</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="后端文档"><span class="title">后端文档</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Spring 系列</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/backend/springboot/helloworld.html" class="" aria-label="Spring Boot"><!--[--><!--]--> Spring Boot <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/backend/springcloud/gateway/Spring-Gateway配置说明.html" class="" aria-label="Spring Cloud"><!--[--><!--]--> Spring Cloud <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/backend/springcloud/gateway/Spring-Gateway配置说明.html" class="" aria-label="Spring Cloud Alibaba"><!--[--><!--]--> Spring Cloud Alibaba <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/database/mysql/base/数据库和SQL概述.html" class="" aria-label="Mysql"><!--[--><!--]--> Mysql <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/database/pxc/安装Percona数据库.html" class="" aria-label="Percona Xtradb Cluster"><!--[--><!--]--> Percona Xtradb Cluster <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/other/linux/Ubuntu设置国内镜像软件源.html" class="" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/docker/Docker安装.html" class="" aria-label="docker"><!--[--><!--]--> docker <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/mix/PigGo+图床.html" class="" aria-label="杂项"><!--[--><!--]--> 杂项 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端"><span class="title">前端</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端"><span class="title">前端</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/web/TypeScript学习.html" class="" aria-label="TypeScript学习"><!--[--><!--]--> TypeScript学习 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/moomhub/Notes" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="切换夜间模式"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/java/newApi/8-17新特性API.html" class="" aria-label="Java 版本特性"><!--[--><!--]--> Java 版本特性 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/java/base/Java环境变量配置.html" class="" aria-label="Java 基础"><!--[--><!--]--> Java 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/java/thread/线程基本概念.html" class="" aria-label="多线程"><!--[--><!--]--> 多线程 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="后端文档"><span class="title">后端文档</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="后端文档"><span class="title">后端文档</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Spring 系列</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/backend/springboot/helloworld.html" class="" aria-label="Spring Boot"><!--[--><!--]--> Spring Boot <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/backend/springcloud/gateway/Spring-Gateway配置说明.html" class="" aria-label="Spring Cloud"><!--[--><!--]--> Spring Cloud <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/backend/springcloud/gateway/Spring-Gateway配置说明.html" class="" aria-label="Spring Cloud Alibaba"><!--[--><!--]--> Spring Cloud Alibaba <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/database/mysql/base/数据库和SQL概述.html" class="" aria-label="Mysql"><!--[--><!--]--> Mysql <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/database/pxc/安装Percona数据库.html" class="" aria-label="Percona Xtradb Cluster"><!--[--><!--]--> Percona Xtradb Cluster <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/other/linux/Ubuntu设置国内镜像软件源.html" class="" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/docker/Docker安装.html" class="" aria-label="docker"><!--[--><!--]--> docker <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/mix/PigGo+图床.html" class="" aria-label="杂项"><!--[--><!--]--> 杂项 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端"><span class="title">前端</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端"><span class="title">前端</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/web/TypeScript学习.html" class="" aria-label="TypeScript学习"><!--[--><!--]--> TypeScript学习 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/moomhub/Notes" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">Gateway 网关服务 <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Spring Gateway 配置说明"><!--[--><!--]--> Spring Gateway 配置说明 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#gateway常用配置" class="router-link-active router-link-exact-active sidebar-item" aria-label="Gateway常用配置"><!--[--><!--]--> Gateway常用配置 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_1、after" class="router-link-active router-link-exact-active sidebar-item" aria-label="1、After"><!--[--><!--]--> 1、After <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_2、before" class="router-link-active router-link-exact-active sidebar-item" aria-label="2、Before"><!--[--><!--]--> 2、Before <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_3、between" class="router-link-active router-link-exact-active sidebar-item" aria-label="3、Between"><!--[--><!--]--> 3、Between <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_4、cookie" class="router-link-active router-link-exact-active sidebar-item" aria-label="4、Cookie"><!--[--><!--]--> 4、Cookie <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_5、header" class="router-link-active router-link-exact-active sidebar-item" aria-label="5、Header"><!--[--><!--]--> 5、Header <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_6、host" class="router-link-active router-link-exact-active sidebar-item" aria-label="6、Host"><!--[--><!--]--> 6、Host <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_7、method" class="router-link-active router-link-exact-active sidebar-item" aria-label="7、Method"><!--[--><!--]--> 7、Method <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_8、path" class="router-link-active router-link-exact-active sidebar-item" aria-label="8、Path"><!--[--><!--]--> 8、Path <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_9、query" class="router-link-active router-link-exact-active sidebar-item" aria-label="9、Query"><!--[--><!--]--> 9、Query <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#二、gatewayfilter-使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="二、GatewayFilter 使用"><!--[--><!--]--> 二、GatewayFilter 使用 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_1、addrequestheader" class="router-link-active router-link-exact-active sidebar-item" aria-label="1、AddRequestHeader"><!--[--><!--]--> 1、AddRequestHeader <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_2、addrequestparameter" class="router-link-active router-link-exact-active sidebar-item" aria-label="2、AddRequestParameter"><!--[--><!--]--> 2、AddRequestParameter <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_3、addresponseheader" class="router-link-active router-link-exact-active sidebar-item" aria-label="3、AddResponseHeader"><!--[--><!--]--> 3、AddResponseHeader <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_4、hystrix" class="router-link-active router-link-exact-active sidebar-item" aria-label="4、Hystrix"><!--[--><!--]--> 4、Hystrix <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_5、fallbackheaders" class="router-link-active router-link-exact-active sidebar-item" aria-label="5、FallbackHeaders"><!--[--><!--]--> 5、FallbackHeaders <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_6、prefixpath" class="router-link-active router-link-exact-active sidebar-item" aria-label="6、PrefixPath"><!--[--><!--]--> 6、PrefixPath <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_7、preservehostheader" class="router-link-active router-link-exact-active sidebar-item" aria-label="7、PreserveHostHeader"><!--[--><!--]--> 7、PreserveHostHeader <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/backend/springcloud/gateway/Spring-Gateway%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E.html#_9、removenonproxyheaders" class="router-link-active router-link-exact-active sidebar-item" aria-label="9、RemoveNonProxyHeaders"><!--[--><!--]--> 9、RemoveNonProxyHeaders <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="/backend/springcloud/gateway/Hystrixs-%E6%96%AD%E8%B7%AF%E7%94%B1%E4%BD%BF%E7%94%A8.html" class="sidebar-item" aria-label="Hystrixs（断路由）使用"><!--[--><!--]--> Hystrixs（断路由）使用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">服务调用 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/backend/springcloud/openfeign/Loadbalancer%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1.html" class="sidebar-item" aria-label="Spring Cloud LoadBalancer"><!--[--><!--]--> Spring Cloud LoadBalancer <!--[--><!--]--></a><!----></li><li><a href="/backend/springcloud/openfeign/Ribbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E6%9C%8D%E5%8A%A1.html" class="sidebar-item" aria-label="Ribbon负载均衡服务调用"><!--[--><!--]--> Ribbon负载均衡服务调用 <!--[--><!--]--></a><!----></li><li><a href="/backend/springcloud/openfeign/%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8OpenFeign.html" class="sidebar-item" aria-label="OpenFeign负载均衡服务调用"><!--[--><!--]--> OpenFeign负载均衡服务调用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Stream 消息驱动 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/backend/springcloud/stream/Spring-Cloud-Stream%E6%B6%88%E6%81%AF%E9%A9%B1%E5%8A%A8%E9%85%8D%E7%BD%AE.html" class="sidebar-item" aria-label="Spring Cloud Stream 配置说明"><!--[--><!--]--> Spring Cloud Stream 配置说明 <!--[--><!--]--></a><!----></li><li><a href="/backend/springcloud/stream/Spring-Cloud-Stream%E6%B6%88%E6%81%AF%E9%A9%B1%E5%8A%A8-%E6%B6%88%E8%B4%B9%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E6%9C%BA%E5%88%B6.html" class="sidebar-item" aria-label="Spring Cloud Stream 消息驱动-消费异常处理机制"><!--[--><!--]--> Spring Cloud Stream 消息驱动-消费异常处理机制 <!--[--><!--]--></a><!----></li><li><a href="/backend/springcloud/stream/Spring-Cloud-Stream%E6%B6%88%E6%81%AF%E9%A9%B1%E5%8A%A8%E6%B6%88%E6%81%AF%E8%BF%87%E6%BB%A4%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F.html" class="sidebar-item" aria-label="Spring Cloud Stream实现消息过滤的三种主要方式"><!--[--><!--]--> Spring Cloud Stream实现消息过滤的三种主要方式 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible"> 整合RockMQ <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/backend/springcloud/stream/Stream%E6%95%B4%E5%90%88Rocketmq%E5%AE%9E%E7%8E%B0%E5%B9%BF%E6%92%AD%E5%92%8C%E9%A1%BA%E5%BA%8F%E6%B6%88%E6%81%AF(%E4%B8%80).html" class="sidebar-item" aria-label="Stream 整合 Rocketmq 实现广播和顺序消息（一）"><!--[--><!--]--> Stream 整合 Rocketmq 实现广播和顺序消息（一） <!--[--><!--]--></a><!----></li><li><a href="/backend/springcloud/stream/Stream%E6%95%B4%E5%90%88Rocketmq%E5%AE%9E%E7%8E%B0%E5%BB%B6%E6%97%B6%E6%B6%88%E6%81%AF(%E4%BA%8C).html" class="sidebar-item" aria-label="Stream 整合 Rocketmq 实现延时消息（二）"><!--[--><!--]--> Stream 整合 Rocketmq 实现延时消息（二） <!--[--><!--]--></a><!----></li><li><a href="/backend/springcloud/stream/Stream%E6%95%B4%E5%90%88Rocketmq%E5%AE%9E%E7%8E%B0%E4%BA%8B%E5%8A%A1%E6%B6%88%E6%81%AF(%E4%B8%89).html" class="sidebar-item" aria-label="Stream 整合 Rocketmq 实现事务消息（三）"><!--[--><!--]--> Stream 整合 Rocketmq 实现事务消息（三） <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">分布式事务 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/backend/springcloud/seata/Seata%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html" class="sidebar-item" aria-label="Seata 分布式事务"><!--[--><!--]--> Seata 分布式事务 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">链路追踪 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/backend/springcloud/%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/Sleuth%E5%92%8CZipkin.html" class="sidebar-item" aria-label="Spring Cloud 链路追踪 - Sleuth和 zipkin"><!--[--><!--]--> Spring Cloud 链路追踪 - Sleuth和 zipkin <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="spring-gateway-配置说明" tabindex="-1"><a class="header-anchor" href="#spring-gateway-配置说明" aria-hidden="true">#</a> Spring Gateway 配置说明</h1><h2 id="gateway常用配置" tabindex="-1"><a class="header-anchor" href="#gateway常用配置" aria-hidden="true">#</a> Gateway常用配置</h2><h3 id="_1、after" tabindex="-1"><a class="header-anchor" href="#_1、after" aria-hidden="true">#</a> 1、After</h3><p>只要当前时间大于设定时间，路由才会匹配请求 - 时间匹配</p><p>这个路由规则会在东8区的2018-12-25 14:33:47<strong>后</strong> ，将请求都转跳到<code>baidu</code>。</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>  
    <span class="token key atrule">cloud</span><span class="token punctuation">:</span>    
        <span class="token key atrule">gateway</span><span class="token punctuation">:</span>      
            <span class="token key atrule">routes</span><span class="token punctuation">:</span>      
            <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> after_route        
              <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//www.baidu.com        
              <span class="token key atrule">predicates</span><span class="token punctuation">:</span>        
              <span class="token punctuation">-</span> After=2018<span class="token punctuation">-</span>12<span class="token punctuation">-</span>25T14<span class="token punctuation">:</span>33<span class="token punctuation">:</span>47.789+08<span class="token punctuation">:</span><span class="token number">00</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2、before" tabindex="-1"><a class="header-anchor" href="#_2、before" aria-hidden="true">#</a> 2、Before</h3><p>只要当前时间小于设定时间，路由才会匹配请求 - 时间匹配</p><p>这个路由规则会在东8区的2018-12-25 14:33:47<strong>前</strong> ，将请求都转跳到google。</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>  
    <span class="token key atrule">cloud</span><span class="token punctuation">:</span>    
        <span class="token key atrule">gateway</span><span class="token punctuation">:</span>      
            <span class="token key atrule">routes</span><span class="token punctuation">:</span>      
            <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> before_route        
              <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//www.google.com        
              <span class="token key atrule">predicates</span><span class="token punctuation">:</span>        
              <span class="token punctuation">-</span> Before=2018<span class="token punctuation">-</span>12<span class="token punctuation">-</span>25T14<span class="token punctuation">:</span>33<span class="token punctuation">:</span>47.789+08<span class="token punctuation">:</span><span class="token number">00</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3、between" tabindex="-1"><a class="header-anchor" href="#_3、between" aria-hidden="true">#</a> 3、Between</h3><p>只要当前时间大于第一个设定时间，并小于第二个设定时间，路由才会匹配请求 - 时间匹配</p><p>这个路由规则会在东8区的2018-12-25 14:33:47到2018-12-26 14:33:47之间，将请求都转跳到google。</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>  
    <span class="token key atrule">cloud</span><span class="token punctuation">:</span>   
        <span class="token key atrule">gateway</span><span class="token punctuation">:</span>      
            <span class="token key atrule">routes</span><span class="token punctuation">:</span>      
            <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> between_route        
              <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//www.google.com        
              <span class="token key atrule">predicates</span><span class="token punctuation">:</span>        
              <span class="token punctuation">-</span> Between=2018<span class="token punctuation">-</span>12<span class="token punctuation">-</span>25T14<span class="token punctuation">:</span>33<span class="token punctuation">:</span>47.789+08<span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">,</span> <span class="token datetime number">2018-12-26T14:33:47.789+08:00</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4、cookie" tabindex="-1"><a class="header-anchor" href="#_4、cookie" aria-hidden="true">#</a> 4、Cookie</h3><p>使用的是cookie名字和正则表达式的value作为两个输入参数，请求的cookie需要匹配cookie名和符合其中value的正则</p><p>路由匹配请求存在cookie名为cookiename，cookie内容匹配cookievalue的，将请求转发到google。</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span> 
    <span class="token key atrule">cloud</span><span class="token punctuation">:</span>    
        <span class="token key atrule">gateway</span><span class="token punctuation">:</span>  
            <span class="token key atrule">routes</span><span class="token punctuation">:</span>      
            <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> cookie_route       
              <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//www.google.com        
              <span class="token key atrule">predicates</span><span class="token punctuation">:</span>        
              <span class="token punctuation">-</span> Cookie=cookiename<span class="token punctuation">,</span> cookievalue
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5、header" tabindex="-1"><a class="header-anchor" href="#_5、header" aria-hidden="true">#</a> 5、Header</h3><p>路由匹配存在名为X-Request-Id，内容为数字的header的请求，将请求转发到google。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:  
    cloud:    
        gateway:     
            routes:      
            - id: header_route        
              uri: http://www.google.com        
              predicates:        
              - Header=X-Request-Id, \d+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6、host" tabindex="-1"><a class="header-anchor" href="#_6、host" aria-hidden="true">#</a> 6、Host</h3><p>使用的是host的列表作为参数，host使用Ant style匹配</p><p>路由会匹配Host诸如：<a href="http://www.somehost.org" target="_blank" rel="noopener noreferrer">www.somehost.org<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 或 beta.somehost.org或www.anotherhost.org等请求。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:  
    cloud:    
        gateway:      
            routes:      
            - id: host_route        
              uri: http://www.google.com        
              predicates:        
              - Host=**.somehost.org,**.anotherhost.org
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7、method" tabindex="-1"><a class="header-anchor" href="#_7、method" aria-hidden="true">#</a> 7、Method</h3><p>Method Route Predicate Factory是通过HTTP的method来匹配路由。</p><p>路由会匹配到所有GET方法的请求。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:  
    cloud:    
        gateway:      
            routes:      
            - id: method_route        
              uri: http://www.google.com        
              predicates:        
              - Method=GET
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8、path" tabindex="-1"><a class="header-anchor" href="#_8、path" aria-hidden="true">#</a> 8、Path</h3><p>Path Route Predicate Factory使用的是path列表作为参数，使用Spring的PathMatcher匹配path，可以设置可选变量。</p><p>上面路由可以匹配诸如：/foo/1 或 /foo/bar 或 /bar/baz等 其中的segment变量可以通过下面方式获取：</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:  
    cloud:    
        gateway:      
            routes:      
            - id: host_route        
              uri: http://www.google.com       
              predicates:        
              - Path=/foo/{segment},/bar/{segment}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_9、query" tabindex="-1"><a class="header-anchor" href="#_9、query" aria-hidden="true">#</a> 9、Query</h3><p>Query Route Predicate Factory可以通过一个或两个参数来匹配路由，一个是查询的name，一个是查询的正则value。</p><p>路由会匹配所有包含baz查询参数的请求</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>  
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>    
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>      
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>      
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> query_route        
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//www.google.com        
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>        
        <span class="token punctuation">-</span> Query=baz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>10、RemoteAddr</p><p>RemoteAddr Route Predicate Factory通过无类别域间路由(IPv4 or IPv6)列表匹配路由。</p><p>路由就会匹配RemoteAddr诸如192.168.1.10等请求。</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>  
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>    
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>    
          <span class="token key atrule">routes</span><span class="token punctuation">:</span>      
          <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> remoteaddr_route        
            <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//www.google.com        
            <span class="token key atrule">predicates</span><span class="token punctuation">:</span>        
            <span class="token punctuation">-</span> RemoteAddr=192.168.1.1/24
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="二、gatewayfilter-使用" tabindex="-1"><a class="header-anchor" href="#二、gatewayfilter-使用" aria-hidden="true">#</a> 二、GatewayFilter 使用</h2><p>Route filters可以通过一些方式修改HTTP请求的输入和输出，针对某些特殊的场景，Spring Cloud Gateway已经内置了很多不同功能的GatewayFilter Factories。</p><h3 id="_1、addrequestheader" tabindex="-1"><a class="header-anchor" href="#_1、addrequestheader" aria-hidden="true">#</a> 1、AddRequestHeader</h3><p>AddRequestHeader GatewayFilter Factory通过配置name和value可以增加请求的header。</p><p>对匹配的请求，会额外添加X-Request-Foo:Bar的header。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:  
  cloud:    
    gateway:   
          routes: 
            - id: add_request_header_route  
              uri: http://www.google.com  
              filters:
              - AddRequestHeader=X-Request-Foo, Bar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2、addrequestparameter" tabindex="-1"><a class="header-anchor" href="#_2、addrequestparameter" aria-hidden="true">#</a> 2、AddRequestParameter</h3><p>AddRequestParameter GatewayFilter Factory通过配置name和value可以增加请求的参数</p><p>对匹配的请求，会额外添加foo=bar的请求参数。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:  
  cloud:  
      gateway:   
          routes:      
          - id: add_request_parameter_route     
              uri: http://www.google.com     
              filters:       
              - AddRequestParameter=foo, bar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3、addresponseheader" tabindex="-1"><a class="header-anchor" href="#_3、addresponseheader" aria-hidden="true">#</a> 3、AddResponseHeader</h3><p>AddResponseHeader GatewayFilter Factory通过配置name和value可以增加响应的header。</p><p>对匹配的请求，响应返回时会额外添加X-Response-Foo:Bar的header返回。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:  
  cloud:   
      gateway:  
          routes:      
          - id: add_request_header_route    
              uri: http://www.google.com     
              filters:        
              - AddResponseHeader=X-Response-Foo, Bar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4、hystrix" tabindex="-1"><a class="header-anchor" href="#_4、hystrix" aria-hidden="true">#</a> 4、Hystrix</h3><p>Hystrix是Netflix实现的断路器模式工具包，The Hystrix GatewayFilter就是将断路器使用在gateway的路由上，目的是保护你的服务避免级联故障，以及在下游失败时可以降级返回。</p><p>项目里面引入spring-cloud-starter-netflix-hystrix依赖，并提供HystrixCommand的名字，即可生效Hystrix GatewayFilter</p><p>Hystrix过滤器也是通过配置可以参数fallbackUri，来支持路由熔断后的降级处理，降级后，请求会跳过fallbackUri配置的路径，目前只支持forward:的URI协议</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>  cloud:
    gateway:
      routes:
      - id: hystrix_route
        uri: lb://backing-service:8088
        predicates:
        - Path=/consumingserviceendpoint
        filters:
        - name: Hystrix
          args:
            name: fallbackcmd
            fallbackUri: forward:/incaseoffailureusethis
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>生成一个名为<code>**fallbackcmd**</code>的HystrixGatewayFilter 拦截器。 Hystrix降级后就会将请求转发到/incaseoffailureusethis。</p><p>整个流程其实是用fallbackUri将请求跳转到gateway内部的controller或者handler，然而也可以通过以下的方式将请求转发到外部的服务： gateway降级后就会将请求转发到<a href="http://localhost:9994%E3%80%82" target="_blank" rel="noopener noreferrer">http://localhost:9994。<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:
  cloud:
    gateway:
      routes:
      - id: ingredients
        uri: lb://ingredients
        predicates:
        - Path=//ingredients/**
        filters:
        - name: Hystrix
          args:
            name: fetchIngredients
            fallbackUri: forward:/fallback
      - id: ingredients-fallback
        uri: http://localhost:9994
        predicates:
        - Path=/fallback
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>设置 hystrix 熔断器的超时信息</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">hystrix</span><span class="token punctuation">:</span>
  <span class="token key atrule">command</span><span class="token punctuation">:</span>
  <span class="token comment"># 全局的超时信息</span>
    <span class="token key atrule">default</span><span class="token punctuation">:</span>
      <span class="token key atrule">execution</span><span class="token punctuation">:</span>
        <span class="token key atrule">isolation</span><span class="token punctuation">:</span>
          <span class="token key atrule">thread</span><span class="token punctuation">:</span>
            <span class="token key atrule">timeoutInMilliseconds</span><span class="token punctuation">:</span> <span class="token number">10000</span>
    <span class="token comment"># 具体到某一个 Hystrix filters name的超时信息</span>
    <span class="token key atrule">socialfallback</span><span class="token punctuation">:</span>
      <span class="token key atrule">execution</span><span class="token punctuation">:</span>
        <span class="token key atrule">isolation</span><span class="token punctuation">:</span>
          <span class="token key atrule">thread</span><span class="token punctuation">:</span>
            <span class="token key atrule">timeoutInMilliseconds</span><span class="token punctuation">:</span> <span class="token number">60000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5、fallbackheaders" tabindex="-1"><a class="header-anchor" href="#_5、fallbackheaders" aria-hidden="true">#</a> 5、FallbackHeaders</h3><p>FallbackHeaders GatewayFilter Factory可以将Hystrix执行的异常信息添加到外部请求的fallbackUriheader上。</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> ingredients
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//ingredients
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> Path=//ingredients/<span class="token important">**</span>
        <span class="token key atrule">filters</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Hystrix
          <span class="token key atrule">args</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> fetchIngredients
            <span class="token key atrule">fallbackUri</span><span class="token punctuation">:</span> forward<span class="token punctuation">:</span>/fallback
      <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> ingredients<span class="token punctuation">-</span>fallback
        <span class="token key atrule">uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">9994</span>
        <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> Path=/fallback
        <span class="token key atrule">filters</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> FallbackHeaders
          <span class="token key atrule">args</span><span class="token punctuation">:</span>
            <span class="token key atrule">executionExceptionTypeHeaderName</span><span class="token punctuation">:</span> Test<span class="token punctuation">-</span>Header
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，当请求lb://ingredients降级后，FallbackHeadersfilter会将HystrixCommand的异常信息，通过Test-Header带给<a href="http://localhost:9994%E6%9C%8D%E5%8A%A1%E3%80%82" target="_blank" rel="noopener noreferrer">http://localhost:9994服务。<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a></p><p>你也可以使用默认的header，也可以像上面一下配置修改header的名字：</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>executionExceptionTypeHeaderName (&quot;Execution-Exception-Type&quot;)

executionExceptionMessageHeaderName (&quot;Execution-Exception-Message&quot;)

rootCauseExceptionTypeHeaderName (&quot;Root-Cause-Exception-Type&quot;)

rootCauseExceptionMessageHeaderName (&quot;Root-Cause-Exception-Message&quot;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6、prefixpath" tabindex="-1"><a class="header-anchor" href="#_6、prefixpath" aria-hidden="true">#</a> 6、PrefixPath</h3><p>PrefixPath GatewayFilter Factor通过设置prefix参数来路径前缀。</p><p>如果一个请求是/hello，通过上面路由，就会将请求修改为/mypath/hello。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:
  cloud:
    gateway:
      routes:
      - id: prefixpath_route
        uri: http://www.google.com
        filters:
        - PrefixPath=/mypath
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7、preservehostheader" tabindex="-1"><a class="header-anchor" href="#_7、preservehostheader" aria-hidden="true">#</a> 7、PreserveHostHeader</h3><p>PreserveHostHeader GatewayFilter Factory会保留原始请求的host头信息，并原封不动的转发出去，而不是被gateway的http客户端重置。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:
  cloud:
    gateway:
      routes:
      - id: preserve_host_route
        uri: http://www.google.com
        filters:
        - PreserveHostHeader
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>8、RequestRateLimiter</p><p>RequestRateLimiter GatewayFilter Factory使用RateLimiter来决定当前请求是否允许通过，如果不允许，则默认返回状态码HTTP 429 - Too Many Requests。</p><p>RequestRateLimiter GatewayFilter可以使用一个可选参数keyResolver来做速率限制。</p><p>keyResolver是KeyResolver接口的一个实现bean，在配置里面，通过SpEL表达式#{@myKeyResolver}来管理bean的名字myKeyResolver</p><h3 id="_9、removenonproxyheaders" tabindex="-1"><a class="header-anchor" href="#_9、removenonproxyheaders" aria-hidden="true">#</a> 9、RemoveNonProxyHeaders</h3><p>RemoveNonProxyHeaders GatewayFilter Factory转发请求是会根据IETF的定义，默认会移除下列的http头信息：</p><ol><li><p>Connection</p></li><li><p>Keep-Alive</p></li><li><p>Proxy-Authenticate</p></li><li><p>Proxy-Authorization</p></li><li><p>TE</p></li><li><p>Trailer</p></li><li><p>Transfer-Encoding</p></li><li><p>Upgrade</p></li></ol><p>你也可以通过配置spring.cloud.gateway.filter.remove-non-proxy-headers.headers来更改需要移除的header列表。</p><p>10、RemoveRequestHeader</p><p>RemoveRequestHeader GatewayFilter Factory配置header的name，即可以移除请求的header。<br>路由在发送请求给下游时，会将请求中的X-Request-Foo头信息去掉。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:
  cloud:
    gateway:
      routes:
      - id: removerequestheader_route
        uri: http://www.google.com
        filters:
        - RemoveRequestHeader=X-Request-Foo
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>11、RemoveResponseHeader</p><p>RemoveResponseHeader GatewayFilter Factory通过配置header的name，会在响应返回时移除header。</p><p>路由会在响应返回给gateway的客户端时，将X-Response-Foo响应头信息去掉。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:
  cloud:
    gateway:
      routes:
      - id: removeresponseheader_route
        uri: http://www.google.com
        filters:
        - RemoveResponseHeader=X-Response-Foo
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>12、RewritePath</p><p>RewritePath GatewayFilter Factory使用路径regexp和替换路径replacement两个参数做路径重写，两个都可以灵活地使用java的正则表达式。</p><p>如果请求的路径是/foo/bar，则gateway会将请求路径改为/bar发送给下游。</p><blockquote><p>在YAML 的格式中使用。</p></blockquote><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>  cloud:
    gateway:
      routes:
      - id: rewritepath_route
        uri: http://www.google.com
        predicates:
        - Path=/foo/**
        filters:
        - RewritePath=/foo/(?&lt;segment&gt;.*), /$\{segment}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>13、RewriteResponseHeader 、</p><p>RewriteResponseHeader GatewayFilter Factory的作用是修改响应返回的header内容，需要配置响应返回的header的name，匹配规则regexp和替换词replacement，也是支持java的正则表达式。</p><p>举个例子，对于上面的filter，如果响应的headerX-Response-Foo的内容是/42?user=ford&amp;password=omg!what&amp;flag=true，这个内容会修改为/42?user=ford&amp;password=***&amp;flag=true。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:
  cloud:
    gateway:
      routes:
      - id: rewriteresponseheader_route
        uri: http://www.google.com
        filters:
        - RewriteResponseHeader=X-Response-Foo, , password=[^&amp;]+, password=***
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>14、SaveSession</p><p>SaveSession GatewayFilter Factory会在请求下游时强制执行WebSession::save方法，用在那种像Spring Session延迟数据存储的，并在请求转发前确保session状态保存情况。</p><p>如果你将Spring Secutiry于Spring Session集成使用，并想确保安全信息都传到下游机器，你就需要配置这个filter。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>  cloud:
    gateway:
      routes:
      - id: save_session
        uri: http://www.google.com
        predicates:
        - Path=/foo/**
        filters:
        - SaveSession
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>15、SecureHeaders</p><p>SecureHeaders GatewayFilter Factory会添加在返回响应中一系列安全作用的header，至于为什么，英文好的可以看一下这篇博客。</p><p>默认会添加这些头信息和默认内容：</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>X-Xss-Protection:1; mode=block

Strict-Transport-Security:max-age=631138519

X-Frame-Options:DENY

X-Content-Type-Options:nosniff

Referrer-Policy:no-referrer

Content-Security-Policy:default-src &#39;self&#39; https:; font-src &#39;self&#39; https: data:; img-src &#39;self&#39; https: data:; object-src &#39;none&#39;; script-src https:; style-src &#39;self&#39; https: &#39;unsafe-inline&#39;

X-Download-Options:noopen

X-Permitted-Cross-Domain-Policies:none
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果你想修改这些头信息的默认内容，可以在配置文件中添加下面的配置：</p><p>前缀：spring.cloud.gateway.filter.secure-headers</p><p>上面的header对应的后缀：</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>xss-protection-header

strict-transport-security

frame-options

content-type-options

referrer-policy

content-security-policy

download-options

permitted-cross-domain-policies
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>前后缀接起来即可，如：spring.cloud.gateway.filter.secure-headers.xss-protection-header</p><p>16、SetPath</p><p>SetPath GatewayFilter Factory采用路径template参数，通过请求路径的片段的模板化，来达到操作修改路径的母的，运行多个路径片段模板化</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>  cloud:
    gateway:
      routes:
      - id: setpath_route
        uri: http://www.google.com
        predicates:
        - Path=/foo/{segment}
        filters:
        - SetPath=/{segment}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对于上面的例子，如果路径是/foo/bar，则对于下游的请求路径会修改为/bar。</p><p>17、SetResponseHeader</p><p>SetResponseHeader GatewayFilter Factory通过设置name和value来替换响应对于的header</p><p>对于上面的例子，如果下游的返回带有头信息为X-Response-Foo:1234，则会gateway会替换为X-Response-Foo:Bar，在返回给客户端。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:  
   cloud:  
     gateway:        
       routes:      
       - id: setresponseheader_route      
          uri: http://www.google.com      
          filters:      
          - SetResponseHeader=X-Response-Foo, Bar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>18、SetStatus</p><p>SetStatus GatewayFilter Factory通过配置有效的Spring HttpStatus枚举参数，可以是类似于404的这些数字，也可以是枚举的name字符串，来修改响应的返回码。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:
  cloud:
    gateway:
      routes:
      - id: setresponseheader_route
        uri: http://www.google.com
        filters:
        - SetResponseHeader=X-Response-Foo, Bar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>19、StripPrefix</p><p>StripPrefix GatewayFilter Factory通过配置parts来表示截断路径前缀的数量。</p><p>如果请求的路径为/name/bar/foo，则路径会修改为/foo，即将路径的两个前缀去掉了。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:
  cloud:
    gateway:
      routes:
      - id: nameRoot
        uri: http://nameservice
        predicates:
        - Path=/name/**
        filters:
        - StripPrefix=2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>20、Retry</p><p>Retry GatewayFilter Factory可以配置针对不同的响应做请求重试，可以配置如下参数：</p><ol><li><p>retries: 重试次数</p></li><li><p>statuses: 需要重试的状态码，需要根据枚举 org.springframework.http.HttpStatus来配置</p></li><li><p>methods: 需要重试的请求方法，需要根据枚举org.springframework.http.HttpMethod来配置</p></li><li><p>series: HTTP状态码系列，详情见枚举org.springframework.http.HttpStatus.Series</p></li></ol><p>下游服务返回502状态码时，gateway会重试3次。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:
  cloud:
    gateway:
      routes:
      - id: retry_test
        uri: http://localhost:8080/flakey
        predicates:
        - Host=*.retry.com
        filters:
        - name: Retry
          args:
            retries: 3
            statuses: BAD_GATEWAY
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>21、RequestSize</p><p>RequestSize GatewayFilter Factory会限制客户端请求包的大小，通过参数RequestSize来配置最大上传大小，单位字节。</p><p>如果请求大小超过5000kb限制，则会返回状态码413 Payload Too Large。</p><blockquote><p>如果不设置这个filter，默认限制5M的请求大小。</p></blockquote><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>spring:
  cloud:
    gateway:
      routes:
      - id: request_size_route
      uri: http://localhost:8080/upload
      predicates:
      - Path=/upload
      filters:
      - name: RequestSize
        args:
          maxSize: 5000000
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Modify Request Body GatewayFilter Factory</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>官方说这个filter目前只是beta版本，API以后可能会修改。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Modify Request Body GatewayFilter Factory可以修改请求体内容，这个只能通过java来配置。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>@Bean
public RouteLocator routes(RouteLocatorBuilder builder) {
    return builder.routes()
        .route(&quot;rewrite_request_obj&quot;, r -&gt; r.host(&quot;*.rewriterequestobj.org&quot;)
            .filters(f -&gt; f.prefixPath(&quot;/httpbin&quot;)
                .modifyRequestBody(String.class, Hello.class, MediaType.APPLICATION_JSON_VALUE,
                    (exchange, s) -&gt; return Mono.just(new Hello(s.toUpperCase())))).uri(uri))
        .build();
}
 
static class Hello {
    String message;
 
    public Hello() { }
 
    public Hello(String message) {
        this.message = message;
    }
 
    public String getMessage() {
        return message;
    }
 
    public void setMessage(String message) {
        this.message = message;
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>Modify Response Body GatewayFilter Factory</li></ol><p>官方说这个filter目前只是beta版本，API以后可能会修改。</p><p>Modify Response Body GatewayFilter Factory用于修改响应返回的内容，同样只能通过java配置。</p><div class="language-纯文本 ext-纯文本 line-numbers-mode"><pre class="language-纯文本"><code>@Bean
public RouteLocator routes(RouteLocatorBuilder builder) {
    return builder.routes()
        .route(&quot;rewrite_response_upper&quot;, r -&gt; r.host(&quot;*.rewriteresponseupper.org&quot;)
            .filters(f -&gt; f.prefixPath(&quot;/httpbin&quot;)
            .modifyResponseBody(String.class, String.class,
                (exchange, s) -&gt; Mono.just(s.toUpperCase()))).uri(uri)
        .build();
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/moomhub/Notes/edit/main/docs/backend/springcloud/gateway/Spring-Gateway配置说明.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页"><!--[--><!--]--> 在 GitHub 上编辑此页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 2208300539@qq.com">MoomHub</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><!----><span class="next"><a href="/backend/springcloud/gateway/Hystrixs-%E6%96%AD%E8%B7%AF%E7%94%B1%E4%BD%BF%E7%94%A8.html" class="" aria-label="Hystrixs（断路由）使用"><!--[--><!--]--> Hystrixs（断路由）使用 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.4a9c1875.js" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en-Zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.46">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/icon/favicon.ico"><meta name="application-name" content="MoomHub"><meta name="apple-mobile-web-app-title" content="MoomHub"><title>Mysql 语句优化 | 青衣水袖</title><meta name="description" content="记录学习信息的文档">
    <link rel="modulepreload" href="/assets/app.4a9c1875.js"><link rel="modulepreload" href="/assets/Mysql查询优化-语句优化.html.7d093d44.js"><link rel="modulepreload" href="/assets/Mysql查询优化-语句优化.html.c1da6748.js"><link rel="prefetch" href="/assets/index.html.468fd202.js"><link rel="prefetch" href="/assets/随机数.html.e3d01a1e.js"><link rel="prefetch" href="/assets/TypeScript学习.html.6baf459a.js"><link rel="prefetch" href="/assets/Spring Boot 使用 Junit5测试.html.296e78aa.js"><link rel="prefetch" href="/assets/SpringBoot使用Log4j2日志框架.html.634eba63.js"><link rel="prefetch" href="/assets/SpringBoot多样化构建Docker.html.afab33b2.js"><link rel="prefetch" href="/assets/SpringBoot拦截器.html.84a45392.js"><link rel="prefetch" href="/assets/SpringBoot注解.html.c6e774de.js"><link rel="prefetch" href="/assets/SpringBoot项目Jar方式运行.html.f02763cf.js"><link rel="prefetch" href="/assets/helloworld.html.862da223.js"><link rel="prefetch" href="/assets/图形监控-Spring-Boot-Admin.html.ac745cbd.js"><link rel="prefetch" href="/assets/监控应用Spring-Boot-Actuator.html.a2cbd6f3.js"><link rel="prefetch" href="/assets/错误处理.html.bca399f9.js"><link rel="prefetch" href="/assets/MySql数据库相关概念.html.61316e19.js"><link rel="prefetch" href="/assets/Mysql查询优化-数据库优化.html.ddeac2f8.js"><link rel="prefetch" href="/assets/Mysql核心-索引.html.a83e5866.js"><link rel="prefetch" href="/assets/Mysql核心-视图.html.a1dbc1f1.js"><link rel="prefetch" href="/assets/Mysql项目-新零售数据库设计.html.1eb8a63b.js"><link rel="prefetch" href="/assets/Mysql项目-程序设计.html.f07fd66b.js"><link rel="prefetch" href="/assets/PerconaTookit工具.html.b175ecb8.js"><link rel="prefetch" href="/assets/mysql数据日志.html.f937338f.js"><link rel="prefetch" href="/assets/常用的Mysql命令.html.30719a11.js"><link rel="prefetch" href="/assets/数据库的备份和恢复.html.f4b612cc.js"><link rel="prefetch" href="/assets/MyCat学习.html.5fd1cd14.js"><link rel="prefetch" href="/assets/PXC集群主机安装.html.37e2d4fb.js"><link rel="prefetch" href="/assets/双主高可用实现负载均衡.html.17b55feb.js"><link rel="prefetch" href="/assets/安装Percona数据库.html.c588eae9.js"><link rel="prefetch" href="/assets/番外.html.9f5cb0f2.js"><link rel="prefetch" href="/assets/Java环境变量配置.html.d4a27ac2.js"><link rel="prefetch" href="/assets/Lambda表达式.html.dba2184e.js"><link rel="prefetch" href="/assets/垃圾回收GC.html.99b5409e.js"><link rel="prefetch" href="/assets/8-17新特性API.html.b23d9a9b.js"><link rel="prefetch" href="/assets/Java10新特性.html.97eb01e2.js"><link rel="prefetch" href="/assets/Java8新特性-Optional.html.37625146.js"><link rel="prefetch" href="/assets/Java8新特性-Stream流式编程.html.00d4be70.js"><link rel="prefetch" href="/assets/Java8新特性-时间类.html.2f925532.js"><link rel="prefetch" href="/assets/Java9新特性.html.bf8818e4.js"><link rel="prefetch" href="/assets/Java并发编程-AQS并发容器同步组件.html.51db2c96.js"><link rel="prefetch" href="/assets/Java线程池.html.ba5e7be1.js"><link rel="prefetch" href="/assets/实现线程的几种方式.html.fe2d808c.js"><link rel="prefetch" href="/assets/指令重排.html.d9439df1.js"><link rel="prefetch" href="/assets/等待唤醒机制.html.017bdafa.js"><link rel="prefetch" href="/assets/线程基本概念.html.757469c1.js"><link rel="prefetch" href="/assets/线程安全.html.e1b26214.js"><link rel="prefetch" href="/assets/线程的生命周期.html.5614bef2.js"><link rel="prefetch" href="/assets/Docker命令说明.html.beba32c0.js"><link rel="prefetch" href="/assets/Docker安装.html.b71e702f.js"><link rel="prefetch" href="/assets/Docker安装Mysql.html.ebbbd647.js"><link rel="prefetch" href="/assets/Docker安装Nacos.html.9f6940f1.js"><link rel="prefetch" href="/assets/Docker安装Web管理平台.html.b15dedb0.js"><link rel="prefetch" href="/assets/Docker运行设置IP.html.d446c915.js"><link rel="prefetch" href="/assets/Docker部署haproxy.html.56c21947.js"><link rel="prefetch" href="/assets/Doker安装Redis.html.2bee4f08.js"><link rel="prefetch" href="/assets/Linux定时脚本.html.3fe35291.js"><link rel="prefetch" href="/assets/Linux问题归档.html.50567e3a.js"><link rel="prefetch" href="/assets/Ubuntu设置国内镜像软件源.html.936fd155.js"><link rel="prefetch" href="/assets/Ubuntu设置远程登陆.html.1a5ecc31.js"><link rel="prefetch" href="/assets/PigGo_图床.html.ff155a0c.js"><link rel="prefetch" href="/assets/WSL2使用文档.html.957f3fb4.js"><link rel="prefetch" href="/assets/Windows使用WSL2.html.6d188cdf.js"><link rel="prefetch" href="/assets/Hystrixs-断路由使用.html.32554b19.js"><link rel="prefetch" href="/assets/Spring-Gateway配置说明.html.317c443f.js"><link rel="prefetch" href="/assets/Loadbalancer负载均衡.html.4d817f71.js"><link rel="prefetch" href="/assets/Ribbon负载均衡服务.html.edf330d3.js"><link rel="prefetch" href="/assets/服务调用OpenFeign.html.2c46cec0.js"><link rel="prefetch" href="/assets/Seata分布式事务.html.481e8b4b.js"><link rel="prefetch" href="/assets/Spring-Cloud-Stream消息驱动-消费异常处理机制.html.786b5aba.js"><link rel="prefetch" href="/assets/Spring-Cloud-Stream消息驱动消息过滤的三种方式.html.02cd38df.js"><link rel="prefetch" href="/assets/Spring-Cloud-Stream消息驱动配置.html.8238b711.js"><link rel="prefetch" href="/assets/Stream整合Rocketmq实现事务消息(三).html.8de1dfbb.js"><link rel="prefetch" href="/assets/Stream整合Rocketmq实现广播和顺序消息(一).html.c980ee80.js"><link rel="prefetch" href="/assets/Stream整合Rocketmq实现延时消息(二).html.1b9c9767.js"><link rel="prefetch" href="/assets/Sleuth和Zipkin.html.a2f0b365.js"><link rel="prefetch" href="/assets/DDL数据库定义语言.html.e7c3eb9e.js"><link rel="prefetch" href="/assets/DML数据处理之增删改.html.47561dd6.js"><link rel="prefetch" href="/assets/SQL练习-01.html.3b5af471.js"><link rel="prefetch" href="/assets/分组函数.html.8473766a.js"><link rel="prefetch" href="/assets/分组查询.html.4dd2e6ab.js"><link rel="prefetch" href="/assets/分页查询.html.d1a872b9.js"><link rel="prefetch" href="/assets/单行函数.html.49d51dd7.js"><link rel="prefetch" href="/assets/基本查询.html.4815160a.js"><link rel="prefetch" href="/assets/排序查询.html.2db265d0.js"><link rel="prefetch" href="/assets/数据事务.html.c916bb27.js"><link rel="prefetch" href="/assets/数据库和SQL概述.html.0f673c1a.js"><link rel="prefetch" href="/assets/条件查询.html.9cdf8def.js"><link rel="prefetch" href="/assets/联合查询.html.9917791e.js"><link rel="prefetch" href="/assets/连接查询.html.b22a4de2.js"><link rel="prefetch" href="/assets/404.html.01fa9517.js"><link rel="prefetch" href="/assets/index.html.5836dbf6.js"><link rel="prefetch" href="/assets/随机数.html.3a815f5c.js"><link rel="prefetch" href="/assets/TypeScript学习.html.adbd8f1d.js"><link rel="prefetch" href="/assets/Spring Boot 使用 Junit5测试.html.e12cb97d.js"><link rel="prefetch" href="/assets/SpringBoot使用Log4j2日志框架.html.ec9f8897.js"><link rel="prefetch" href="/assets/SpringBoot多样化构建Docker.html.758e3dcb.js"><link rel="prefetch" href="/assets/SpringBoot拦截器.html.321a2949.js"><link rel="prefetch" href="/assets/SpringBoot注解.html.8ca4a871.js"><link rel="prefetch" href="/assets/SpringBoot项目Jar方式运行.html.ab0a01da.js"><link rel="prefetch" href="/assets/helloworld.html.44762b40.js"><link rel="prefetch" href="/assets/图形监控-Spring-Boot-Admin.html.8d4ca6ca.js"><link rel="prefetch" href="/assets/监控应用Spring-Boot-Actuator.html.5a40f374.js"><link rel="prefetch" href="/assets/错误处理.html.ab07afd8.js"><link rel="prefetch" href="/assets/MySql数据库相关概念.html.3b9e3bf3.js"><link rel="prefetch" href="/assets/Mysql查询优化-数据库优化.html.a6bbc83b.js"><link rel="prefetch" href="/assets/Mysql核心-索引.html.577b06a8.js"><link rel="prefetch" href="/assets/Mysql核心-视图.html.ec7b22f4.js"><link rel="prefetch" href="/assets/Mysql项目-新零售数据库设计.html.0307ce1d.js"><link rel="prefetch" href="/assets/Mysql项目-程序设计.html.d9827e01.js"><link rel="prefetch" href="/assets/PerconaTookit工具.html.1d426870.js"><link rel="prefetch" href="/assets/mysql数据日志.html.d62edff2.js"><link rel="prefetch" href="/assets/常用的Mysql命令.html.573bd433.js"><link rel="prefetch" href="/assets/数据库的备份和恢复.html.7574270e.js"><link rel="prefetch" href="/assets/MyCat学习.html.a4f01480.js"><link rel="prefetch" href="/assets/PXC集群主机安装.html.04a9ffe0.js"><link rel="prefetch" href="/assets/双主高可用实现负载均衡.html.e603c3de.js"><link rel="prefetch" href="/assets/安装Percona数据库.html.7d1d9ea9.js"><link rel="prefetch" href="/assets/番外.html.4669ca30.js"><link rel="prefetch" href="/assets/Java环境变量配置.html.94200dd4.js"><link rel="prefetch" href="/assets/Lambda表达式.html.e86ff6e4.js"><link rel="prefetch" href="/assets/垃圾回收GC.html.39db3df8.js"><link rel="prefetch" href="/assets/8-17新特性API.html.11150ca2.js"><link rel="prefetch" href="/assets/Java10新特性.html.5da7d147.js"><link rel="prefetch" href="/assets/Java8新特性-Optional.html.ea2715a6.js"><link rel="prefetch" href="/assets/Java8新特性-Stream流式编程.html.ab89bcd5.js"><link rel="prefetch" href="/assets/Java8新特性-时间类.html.a0f829e5.js"><link rel="prefetch" href="/assets/Java9新特性.html.bcbd2596.js"><link rel="prefetch" href="/assets/Java并发编程-AQS并发容器同步组件.html.28d60a64.js"><link rel="prefetch" href="/assets/Java线程池.html.9a838964.js"><link rel="prefetch" href="/assets/实现线程的几种方式.html.6d97db33.js"><link rel="prefetch" href="/assets/指令重排.html.c0f655d4.js"><link rel="prefetch" href="/assets/等待唤醒机制.html.32bee595.js"><link rel="prefetch" href="/assets/线程基本概念.html.285fe513.js"><link rel="prefetch" href="/assets/线程安全.html.9e70119f.js"><link rel="prefetch" href="/assets/线程的生命周期.html.54b9a36a.js"><link rel="prefetch" href="/assets/Docker命令说明.html.10a35eb1.js"><link rel="prefetch" href="/assets/Docker安装.html.9b72fbaf.js"><link rel="prefetch" href="/assets/Docker安装Mysql.html.8e9dcc3d.js"><link rel="prefetch" href="/assets/Docker安装Nacos.html.0c7066c8.js"><link rel="prefetch" href="/assets/Docker安装Web管理平台.html.16b66a1e.js"><link rel="prefetch" href="/assets/Docker运行设置IP.html.e399fc36.js"><link rel="prefetch" href="/assets/Docker部署haproxy.html.30c338c9.js"><link rel="prefetch" href="/assets/Doker安装Redis.html.e01811d9.js"><link rel="prefetch" href="/assets/Linux定时脚本.html.0773130e.js"><link rel="prefetch" href="/assets/Linux问题归档.html.836078cf.js"><link rel="prefetch" href="/assets/Ubuntu设置国内镜像软件源.html.36089e7f.js"><link rel="prefetch" href="/assets/Ubuntu设置远程登陆.html.989392fb.js"><link rel="prefetch" href="/assets/PigGo_图床.html.7c94cd32.js"><link rel="prefetch" href="/assets/WSL2使用文档.html.17f7d9b8.js"><link rel="prefetch" href="/assets/Windows使用WSL2.html.6a552282.js"><link rel="prefetch" href="/assets/Hystrixs-断路由使用.html.e43be0b5.js"><link rel="prefetch" href="/assets/Spring-Gateway配置说明.html.77da2095.js"><link rel="prefetch" href="/assets/Loadbalancer负载均衡.html.3a0a3ad7.js"><link rel="prefetch" href="/assets/Ribbon负载均衡服务.html.7d2b1290.js"><link rel="prefetch" href="/assets/服务调用OpenFeign.html.937ef2d2.js"><link rel="prefetch" href="/assets/Seata分布式事务.html.c4acbc31.js"><link rel="prefetch" href="/assets/Spring-Cloud-Stream消息驱动-消费异常处理机制.html.6aa10f8f.js"><link rel="prefetch" href="/assets/Spring-Cloud-Stream消息驱动消息过滤的三种方式.html.419c75d5.js"><link rel="prefetch" href="/assets/Spring-Cloud-Stream消息驱动配置.html.82681e2a.js"><link rel="prefetch" href="/assets/Stream整合Rocketmq实现事务消息(三).html.9f32a439.js"><link rel="prefetch" href="/assets/Stream整合Rocketmq实现广播和顺序消息(一).html.cd050fc9.js"><link rel="prefetch" href="/assets/Stream整合Rocketmq实现延时消息(二).html.bf43339a.js"><link rel="prefetch" href="/assets/Sleuth和Zipkin.html.1847a36b.js"><link rel="prefetch" href="/assets/DDL数据库定义语言.html.a1b0f725.js"><link rel="prefetch" href="/assets/DML数据处理之增删改.html.4cdfca73.js"><link rel="prefetch" href="/assets/SQL练习-01.html.77d68c39.js"><link rel="prefetch" href="/assets/分组函数.html.cb093a68.js"><link rel="prefetch" href="/assets/分组查询.html.d18eada3.js"><link rel="prefetch" href="/assets/分页查询.html.f56764e6.js"><link rel="prefetch" href="/assets/单行函数.html.deb9ae79.js"><link rel="prefetch" href="/assets/基本查询.html.8310c45c.js"><link rel="prefetch" href="/assets/排序查询.html.d998eca8.js"><link rel="prefetch" href="/assets/数据事务.html.ab27f45c.js"><link rel="prefetch" href="/assets/数据库和SQL概述.html.5ae239f0.js"><link rel="prefetch" href="/assets/条件查询.html.f14c61c1.js"><link rel="prefetch" href="/assets/联合查询.html.d8a5248d.js"><link rel="prefetch" href="/assets/连接查询.html.a0959fc2.js"><link rel="prefetch" href="/assets/404.html.9b9bf036.js"><link rel="prefetch" href="/assets/404.1cfa2fc0.js"><link rel="prefetch" href="/assets/Layout.ce6856c3.js">
    <link rel="stylesheet" href="/assets/style.811e635c.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/png/logo.png" alt="青衣水袖"><span class="site-name can-hide">青衣水袖</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/java/newApi/8-17新特性API.html" class="" aria-label="Java 版本特性"><!--[--><!--]--> Java 版本特性 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/java/base/Java环境变量配置.html" class="" aria-label="Java 基础"><!--[--><!--]--> Java 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/java/thread/线程基本概念.html" class="" aria-label="多线程"><!--[--><!--]--> 多线程 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="后端文档"><span class="title">后端文档</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="后端文档"><span class="title">后端文档</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Spring 系列</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/backend/springboot/helloworld.html" class="" aria-label="Spring Boot"><!--[--><!--]--> Spring Boot <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/backend/springcloud/gateway/Spring-Gateway配置说明.html" class="" aria-label="Spring Cloud"><!--[--><!--]--> Spring Cloud <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/backend/springcloud/gateway/Spring-Gateway配置说明.html" class="" aria-label="Spring Cloud Alibaba"><!--[--><!--]--> Spring Cloud Alibaba <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/database/mysql/base/数据库和SQL概述.html" class="" aria-label="Mysql"><!--[--><!--]--> Mysql <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/database/pxc/安装Percona数据库.html" class="" aria-label="Percona Xtradb Cluster"><!--[--><!--]--> Percona Xtradb Cluster <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/other/linux/Ubuntu设置国内镜像软件源.html" class="" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/docker/Docker安装.html" class="" aria-label="docker"><!--[--><!--]--> docker <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/mix/PigGo+图床.html" class="" aria-label="杂项"><!--[--><!--]--> 杂项 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端"><span class="title">前端</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端"><span class="title">前端</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/web/TypeScript学习.html" class="" aria-label="TypeScript学习"><!--[--><!--]--> TypeScript学习 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/moomhub/Notes" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="切换夜间模式"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Java"><span class="title">Java</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Java"><span class="title">Java</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/java/newApi/8-17新特性API.html" class="" aria-label="Java 版本特性"><!--[--><!--]--> Java 版本特性 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/java/base/Java环境变量配置.html" class="" aria-label="Java 基础"><!--[--><!--]--> Java 基础 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/java/thread/线程基本概念.html" class="" aria-label="多线程"><!--[--><!--]--> 多线程 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="后端文档"><span class="title">后端文档</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="后端文档"><span class="title">后端文档</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Spring 系列</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/backend/springboot/helloworld.html" class="" aria-label="Spring Boot"><!--[--><!--]--> Spring Boot <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/backend/springcloud/gateway/Spring-Gateway配置说明.html" class="" aria-label="Spring Cloud"><!--[--><!--]--> Spring Cloud <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/backend/springcloud/gateway/Spring-Gateway配置说明.html" class="" aria-label="Spring Cloud Alibaba"><!--[--><!--]--> Spring Cloud Alibaba <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/database/mysql/base/数据库和SQL概述.html" class="" aria-label="Mysql"><!--[--><!--]--> Mysql <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/database/pxc/安装Percona数据库.html" class="" aria-label="Percona Xtradb Cluster"><!--[--><!--]--> Percona Xtradb Cluster <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="其他"><span class="title">其他</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="其他"><span class="title">其他</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/other/linux/Ubuntu设置国内镜像软件源.html" class="" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/docker/Docker安装.html" class="" aria-label="docker"><!--[--><!--]--> docker <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/mix/PigGo+图床.html" class="" aria-label="杂项"><!--[--><!--]--> 杂项 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="前端"><span class="title">前端</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="前端"><span class="title">前端</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/web/TypeScript学习.html" class="" aria-label="TypeScript学习"><!--[--><!--]--> TypeScript学习 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/moomhub/Notes" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Mysql基础 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/database/mysql/base/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8CSQL%E6%A6%82%E8%BF%B0.html" class="sidebar-item" aria-label="数据库和SQL概述"><!--[--><!--]--> 数据库和SQL概述 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/base/DDL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9A%E4%B9%89%E8%AF%AD%E8%A8%80.html" class="sidebar-item" aria-label="DDL数据库定义语言"><!--[--><!--]--> DDL数据库定义语言 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/base/DML%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B9%8B%E5%A2%9E%E5%88%A0%E6%94%B9.html" class="sidebar-item" aria-label="DML数据处理之增删改"><!--[--><!--]--> DML数据处理之增删改 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/base/%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2.html" class="sidebar-item" aria-label="基本查询"><!--[--><!--]--> 基本查询 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/base/%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2.html" class="sidebar-item" aria-label="条件查询"><!--[--><!--]--> 条件查询 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/base/%E6%8E%92%E5%BA%8F%E6%9F%A5%E8%AF%A2.html" class="sidebar-item" aria-label="排序查询"><!--[--><!--]--> 排序查询 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/base/%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2.html" class="sidebar-item" aria-label="联合查询"><!--[--><!--]--> 联合查询 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/base/%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2.html" class="sidebar-item" aria-label="连接查询"><!--[--><!--]--> 连接查询 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/base/%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0.html" class="sidebar-item" aria-label="分组函数"><!--[--><!--]--> 分组函数 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/base/%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2.html" class="sidebar-item" aria-label="分组查询"><!--[--><!--]--> 分组查询 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/base/%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2.html" class="sidebar-item" aria-label="分页查询"><!--[--><!--]--> 分页查询 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/base/%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0.html" class="sidebar-item" aria-label="单行函数"><!--[--><!--]--> 单行函数 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/base/%E6%95%B0%E6%8D%AE%E4%BA%8B%E5%8A%A1.html" class="sidebar-item" aria-label="MySQL事务"><!--[--><!--]--> MySQL事务 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/base/SQL%E7%BB%83%E4%B9%A0-01.html" class="sidebar-item" aria-label="SQL练习-01"><!--[--><!--]--> SQL练习-01 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Mysql核心 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/database/mysql/Mysql%E6%A0%B8%E5%BF%83-%E8%A7%86%E5%9B%BE.html" class="sidebar-item" aria-label="视图"><!--[--><!--]--> 视图 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/Mysql%E6%A0%B8%E5%BF%83-%E7%B4%A2%E5%BC%95.html" class="sidebar-item" aria-label="数据的表的优化"><!--[--><!--]--> 数据的表的优化 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">Mysql查询优化 <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Mysql 语句优化"><!--[--><!--]--> Mysql 语句优化 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#where-查询过慢" class="router-link-active router-link-exact-active sidebar-item" aria-label="where 查询过慢"><!--[--><!--]--> where 查询过慢 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#如何确定合适的索引" class="router-link-active router-link-exact-active sidebar-item" aria-label="如何确定合适的索引"><!--[--><!--]--> 如何确定合适的索引 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#重新计数" class="router-link-active router-link-exact-active sidebar-item" aria-label="重新计数"><!--[--><!--]--> 重新计数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#强制使用某个索引" class="router-link-active router-link-exact-active sidebar-item" aria-label="强制使用某个索引"><!--[--><!--]--> 强制使用某个索引 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#count-计数优化" class="router-link-active router-link-exact-active sidebar-item" aria-label="count() 计数优化"><!--[--><!--]--> count() 计数优化 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#count-非索引字段" class="router-link-active router-link-exact-active sidebar-item" aria-label="count(非索引字段)"><!--[--><!--]--> count(非索引字段) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#count-索引字段" class="router-link-active router-link-exact-active sidebar-item" aria-label="count(索引字段)"><!--[--><!--]--> count(索引字段) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#count-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="count(1)"><!--[--><!--]--> count(1) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#count" class="router-link-active router-link-exact-active sidebar-item" aria-label="count(*)"><!--[--><!--]--> count(*) <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#order-by-优化" class="router-link-active router-link-exact-active sidebar-item" aria-label="order by 优化"><!--[--><!--]--> order by 优化 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#order-by-步骤原理" class="router-link-active router-link-exact-active sidebar-item" aria-label="ORDER BY 步骤原理"><!--[--><!--]--> ORDER BY 步骤原理 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#优化-order-by-中间结果集" class="router-link-active router-link-exact-active sidebar-item" aria-label="优化 order by 中间结果集"><!--[--><!--]--> 优化 order by 中间结果集 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#优化-order-by-回表生成完整结果集" class="router-link-active router-link-exact-active sidebar-item" aria-label="优化 order by 回表生成完整结果集"><!--[--><!--]--> 优化 order by 回表生成完整结果集 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#order-by-进行索引覆盖" class="router-link-active router-link-exact-active sidebar-item" aria-label="order by 进行索引覆盖"><!--[--><!--]--> order by 进行索引覆盖 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#order-by-rand-优化-随机取法进行优化" class="router-link-active router-link-exact-active sidebar-item" aria-label="order by rand() 优化(随机取法进行优化)"><!--[--><!--]--> order by rand() 优化(随机取法进行优化) <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#order-by-rand-原理" class="router-link-active router-link-exact-active sidebar-item" aria-label="ORDER BY RAND()原理"><!--[--><!--]--> ORDER BY RAND()原理 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#为什么会慢" class="router-link-active router-link-exact-active sidebar-item" aria-label="为什么会慢?"><!--[--><!--]--> 为什么会慢? <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#解决方法-临时优化方法" class="router-link-active router-link-exact-active sidebar-item" aria-label="解决方法-临时优化方法"><!--[--><!--]--> 解决方法-临时优化方法 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#解决方法-业务方案-推荐" class="router-link-active router-link-exact-active sidebar-item" aria-label="解决方法-业务方案（推荐）"><!--[--><!--]--> 解决方法-业务方案（推荐） <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#优化联合查询" class="router-link-active router-link-exact-active sidebar-item" aria-label="优化联合查询"><!--[--><!--]--> 优化联合查询 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#索引下推-version-5-6" class="router-link-active router-link-exact-active sidebar-item" aria-label="索引下推（Version&lt;=5.6）"><!--[--><!--]--> 索引下推（Version&lt;=5.6） <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#索引左侧用法" class="router-link-active router-link-exact-active sidebar-item" aria-label="索引左侧用法"><!--[--><!--]--> 索引左侧用法 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#联合索引" class="router-link-active router-link-exact-active sidebar-item" aria-label="联合索引"><!--[--><!--]--> 联合索引 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#字符串前缀索引" class="router-link-active router-link-exact-active sidebar-item" aria-label="字符串前缀索引"><!--[--><!--]--> 字符串前缀索引 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#字符串-like-只支持右模糊" class="router-link-active router-link-exact-active sidebar-item" aria-label="字符串 like 只支持右模糊"><!--[--><!--]--> 字符串 like 只支持右模糊 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#is-null-优化" class="router-link-active router-link-exact-active sidebar-item" aria-label="IS NULL 优化"><!--[--><!--]--> IS NULL 优化 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#尽量少用-运算符" class="router-link-active router-link-exact-active sidebar-item" aria-label="尽量少用 != 运算符"><!--[--><!--]--> 尽量少用 != 运算符 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#尽量少用-in-和-not-in-运算符" class="router-link-active router-link-exact-active sidebar-item" aria-label="尽量少用 IN 和 NOT IN 运算符"><!--[--><!--]--> 尽量少用 IN 和 NOT IN 运算符 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#在表达式左侧使用运算符和函数都会让索引失效" class="router-link-active router-link-exact-active sidebar-item" aria-label="在表达式左侧使用运算符和函数都会让索引失效"><!--[--><!--]--> 在表达式左侧使用运算符和函数都会让索引失效 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#为什么扫描行数非常少" class="router-link-active router-link-exact-active sidebar-item" aria-label="为什么扫描行数非常少?"><!--[--><!--]--> 为什么扫描行数非常少? <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#松散索引扫描-mysql-8-0-才支持" class="router-link-active router-link-exact-active sidebar-item" aria-label="松散索引扫描（MySql 8.0 才支持）"><!--[--><!--]--> 松散索引扫描（MySql 8.0 才支持） <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#索引失效-不走索引" class="router-link-active router-link-exact-active sidebar-item" aria-label="索引失效，不走索引"><!--[--><!--]--> 索引失效，不走索引 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#字段进行了函数操作" class="router-link-active router-link-exact-active sidebar-item" aria-label="字段进行了函数操作"><!--[--><!--]--> 字段进行了函数操作 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#时间函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="时间函数"><!--[--><!--]--> 时间函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#字符串与数字比较" class="router-link-active router-link-exact-active sidebar-item" aria-label="字符串与数字比较"><!--[--><!--]--> 字符串与数字比较 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#隐式字符编码转换" class="router-link-active router-link-exact-active sidebar-item" aria-label="隐式字符编码转换"><!--[--><!--]--> 隐式字符编码转换 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#分页查询优化" class="router-link-active router-link-exact-active sidebar-item" aria-label="分页查询优化"><!--[--><!--]--> 分页查询优化 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#偏移量大时-效率低" class="router-link-active router-link-exact-active sidebar-item" aria-label="偏移量大时，效率低"><!--[--><!--]--> 偏移量大时，效率低 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#优化-sql" class="router-link-active router-link-exact-active sidebar-item" aria-label="优化 SQL"><!--[--><!--]--> 优化 SQL <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96.html#要不要使用子查询" class="router-link-active router-link-exact-active sidebar-item" aria-label="要不要使用子查询"><!--[--><!--]--> 要不要使用子查询 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96.html" class="sidebar-item" aria-label="数据库优化"><!--[--><!--]--> 数据库优化 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Mysql工具 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/database/mysql/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D.html" class="sidebar-item" aria-label="数据库的备份和恢复（热备份）"><!--[--><!--]--> 数据库的备份和恢复（热备份） <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">数据库其他文档 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/database/mysql/MySql%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5.html" class="sidebar-item" aria-label="MySql 数据库"><!--[--><!--]--> MySql 数据库 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/mysql%E6%95%B0%E6%8D%AE%E6%97%A5%E5%BF%97.html" class="sidebar-item" aria-label="Mysql 数据日志"><!--[--><!--]--> Mysql 数据日志 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/%E5%B8%B8%E7%94%A8%E7%9A%84Mysql%E5%91%BD%E4%BB%A4.html" class="sidebar-item" aria-label="常用的 Mysql 操作命令"><!--[--><!--]--> 常用的 Mysql 操作命令 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/PerconaTookit%E5%B7%A5%E5%85%B7.html" class="sidebar-item" aria-label="PerconaTookit 工具"><!--[--><!--]--> PerconaTookit 工具 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D.html" class="sidebar-item" aria-label="数据库的备份和恢复（热备份）"><!--[--><!--]--> 数据库的备份和恢复（热备份） <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">数据库案例-新零售商城数据库设计 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/database/mysql/Mysql%E9%A1%B9%E7%9B%AE-%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1.html" class="sidebar-item" aria-label="Mysql 数据库设计"><!--[--><!--]--> Mysql 数据库设计 <!--[--><!--]--></a><!----></li><li><a href="/database/mysql/Mysql%E9%A1%B9%E7%9B%AE-%E6%96%B0%E9%9B%B6%E5%94%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1.html" class="sidebar-item" aria-label="新零售数据库设计"><!--[--><!--]--> 新零售数据库设计 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="mysql-语句优化" tabindex="-1"><a class="header-anchor" href="#mysql-语句优化" aria-hidden="true">#</a> Mysql 语句优化</h1><blockquote><p>使用 MySQL 官网提供的测试数据库来进行演示（DVD 租赁公司）</p></blockquote><h2 id="where-查询过慢" tabindex="-1"><a class="header-anchor" href="#where-查询过慢" aria-hidden="true">#</a> where 查询过慢</h2><p>使用索引覆盖进行优化 where 语句。</p><p>覆盖索引指的是:查询语句从执行到返回结果均使用同一个索引，覆盖索引可以有效减少回表</p><blockquote><p>覆盖索引通过取消回表操作，提升查询效率，若数据的查询不只使用了一个索引，则不是覆盖索引，可以通过优化 SQL 语句或优化联合索引，来使用覆盖索引</p></blockquote><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SHOW CREATE TABLE inventory;
# 创建表
CREATE TABLE `inventory_1` (
  `inventory_id` MEDIUMINT UNSIGNED NOT NULL AUTO_INCREMENT,
  `film_id` SMALLINT UNSIGNED NOT NULL,
  `store_id` TINYINT UNSIGNED NOT NULL,
  `last_update` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`inventory_id`),
  KEY `idx_fk_film_id` (`film_id`)
) ENGINE=INNODB DEFAULT CHARSET=utf8;

#复制数据
INSERT INTO inventory_1 SELECT * FROM inventory;

SELECT store_id, film_id FROM sakila.inventory WHERE store_id = 1;

SELECT store_id, film_id FROM sakila.inventory_1 WHERE store_id = 1;

EXPLAIN SELECT store_id, film_id FROM sakila.inventory WHERE store_id = 1;

EXPLAIN SELECT store_id, film_id FROM sakila.inventory_1 WHERE store_id = 1;

#索引覆盖
EXPLAIN SELECT inventory_id, store_id, film_id FROM sakila.inventory WHERE store_id = 1;
#回滚数据表 (减少不必要的字段) （查询中的字段中使用了last_update字段，该字段在数据库中并无索引）
EXPLAIN SELECT inventory_id, store_id, film_id,last_update FROM sakila.inventory WHERE store_id = 1;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="如何确定合适的索引" tabindex="-1"><a class="header-anchor" href="#如何确定合适的索引" aria-hidden="true">#</a> 如何确定合适的索引</h3><p>如何确定用哪条索引</p><p>MySQL 在选取索引时，会参考索引的基数(Cardinality)、基数是 MySQL 估算的，反映这个字段有多少种取值</p><blockquote><p>如果数据量过大，MySQL 会自动选取几个页算出取值的平均值，再乘以页数，即为基数</p></blockquote><p>参考</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>#创建测试表并插入数据
CREATE TABLE `city_1` ( `city` VARCHAR(50) NOT NULL) ;
INSERT INTO sakila.city_1 SELECT city FROM sakila.city;
INSERT INTO sakila.city_1 SELECT city FROM sakila.city;
INSERT INTO sakila.city_1 SELECT city FROM sakila.city;
INSERT INTO sakila.city_1 SELECT city FROM sakila.city;
INSERT INTO sakila.city_1 SELECT city FROM sakila.city;
# 打乱排序
UPDATE city_1 SET city =(SELECT city FROM city ORDER BY RAND() LIMIT 1);


#通过取前缀索引来划分相关的基数
ALTER TABLE sakila.city_1 ADD key (city(1));
ALTER TABLE sakila.city_1 ADD key (city(2));
ALTER TABLE sakila.city_1 ADD key (city(3));
ALTER TABLE sakila.city_1 ADD key (city(4));
ALTER TABLE sakila.city_1 ADD key (city(5));
ALTER TABLE sakila.city_1 ADD key (city(6));
ALTER TABLE sakila.city_1 ADD key (city(7));
ALTER TABLE sakila.city_1 ADD key (city(8));

SHOW INDEX FROM city_1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://cdn.jsdelivr.net/gh/moomhub/notes_images01/images/gawfzdjZroSep2h.png" alt="image-20210901161152550"></p><h3 id="重新计数" tabindex="-1"><a class="header-anchor" href="#重新计数" aria-hidden="true">#</a> 重新计数</h3><blockquote><p>analyze table 可以重新统计索引信息重新统计索引信息时，会重新计算索引的基数</p></blockquote><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>analyze table city_1;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="强制使用某个索引" tabindex="-1"><a class="header-anchor" href="#强制使用某个索引" aria-hidden="true">#</a> 强制使用某个索引</h3><blockquote><p>关键字: force index(&#39;xxx&#39;)</p></blockquote><p>例子</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT * FROM city_1 FORCE INDEX (&#39;xxx&#39;) where xxx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="count-计数优化" tabindex="-1"><a class="header-anchor" href="#count-计数优化" aria-hidden="true">#</a> count() 计数优化</h2><p>MySQL count()函数用来统计结果集中不为 null 的数据个数</p><ol><li>首先存储引擎查询出结果集</li><li>server 层逐个结果判断是否为 null，不为 null 则加 1</li></ol><p><strong>理论上：count(非索引字段) &lt; count(索引字段) &lt; count(1) &lt; count(*)</strong></p><h3 id="count-非索引字段" tabindex="-1"><a class="header-anchor" href="#count-非索引字段" aria-hidden="true">#</a> count(非索引字段)</h3><p>count(非索引字段)时，server 层需要判断每个数据是否为 null</p><h3 id="count-索引字段" tabindex="-1"><a class="header-anchor" href="#count-索引字段" aria-hidden="true">#</a> count(索引字段)</h3><p>count(索引字段)，可以覆盖，依然需要每次判断字段是否为 null，count(主键)，同理</p><h3 id="count-1" tabindex="-1"><a class="header-anchor" href="#count-1" aria-hidden="true">#</a> count(1)</h3><p>count(1)只有扫描索引树，没有解析数据行的过程，理论更快，但 Server 层依然每次需要判断“1 是否为 null&quot;</p><h3 id="count" tabindex="-1"><a class="header-anchor" href="#count" aria-hidden="true">#</a> count(*)</h3><p><code>count(*)</code>一般用来返回数据表行数 MylSAM 的<code>count(*)</code>直接返回数据库中记录的数据表行数，由于 InnoDB 支持事务，数据库中不记录数据表行数 MySQL 专门优化了 count(*)函数直接返回索引树中数据的个数</p><h2 id="order-by-优化" tabindex="-1"><a class="header-anchor" href="#order-by-优化" aria-hidden="true">#</a> order by 优化</h2><h3 id="order-by-步骤原理" tabindex="-1"><a class="header-anchor" href="#order-by-步骤原理" aria-hidden="true">#</a> ORDER BY 步骤原理</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT * FROM `film` WHERE film_id &gt; 80 ORDER BY title;
#执行步骤
#1、查询where 语句
SELECT * FROM `film` WHERE film_id &gt; 80
#2、进行order排序
ORDER BY title
#3、回表生成完整结果集（若需要)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="优化-order-by-中间结果集" tabindex="-1"><a class="header-anchor" href="#优化-order-by-中间结果集" aria-hidden="true">#</a> 优化 order by 中间结果集</h3><blockquote><p>原理：中间表较小时,会直接防止内存中，较大 <strong>sort_buffer_size</strong> 时 放在硬盘中。</p></blockquote><p>优化内存占用 :减少 sort_buffer_size 减少内存 直接走硬盘数据(不推荐)</p><p>增大 sort_buffer_size (推荐)</p><h3 id="优化-order-by-回表生成完整结果集" tabindex="-1"><a class="header-anchor" href="#优化-order-by-回表生成完整结果集" aria-hidden="true">#</a> 优化 order by 回表生成完整结果集</h3><blockquote><p>当行小于 max_length_for_sort_data 时，生成全字段中间表</p></blockquote><p>大于阈值时，只生成排序字段＋主键中间表，需要回表，调大阈值并不一定改善效率，因为太大的结果集排序效率低</p><h3 id="order-by-进行索引覆盖" tabindex="-1"><a class="header-anchor" href="#order-by-进行索引覆盖" aria-hidden="true">#</a> order by 进行索引覆盖</h3><p>通过对中间进行索引</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>#ORDER字段需要有索引(或在联合索引左侧)\其他相关字段(条件、输出)均在上述的索引中
SELECT film_id, title FROM `film` ORDER BY title;

#如果需要添加where 只能对索引进行where 处理
SELECT film_id, title FROM`film` where title like &#39;M%&#39; ORDER BY title
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="order-by-rand-优化-随机取法进行优化" tabindex="-1"><a class="header-anchor" href="#order-by-rand-优化-随机取法进行优化" aria-hidden="true">#</a> order by rand() 优化(随机取法进行优化)</h2><h3 id="order-by-rand-原理" tabindex="-1"><a class="header-anchor" href="#order-by-rand-原理" aria-hidden="true">#</a> ORDER BY RAND()原理</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT title, description FROM `film`ORDER BY RAND()LIMIT 1;
# 执行顺序
1.创建一个临时表，临时表的字段为rand . title、description

2.从表中取出一行，调用RAND()，将结果和数据放入临时表，以此类推

3.针对临时表，将rand字段+行位置（主键)放入sort buffer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行顺序</p><p><img src="https://cdn.jsdelivr.net/gh/moomhub/notes_images01/images/4MeCskRzG7bcyIF.png" alt="image-20210901175007507"></p><p><img src="https://cdn.jsdelivr.net/gh/moomhub/notes_images01/images/mtKfisCzeRYONVI.png" alt="image-20210901175017031"></p><p><img src="https://cdn.jsdelivr.net/gh/moomhub/notes_images01/images/UxFpEtMRC2vP5Iq.png" alt="image-20210901175052299"></p><p><img src="https://cdn.jsdelivr.net/gh/moomhub/notes_images01/images/ahtgmer4YiQFcEN.png" alt="image-20210901175208423"></p><h3 id="为什么会慢" tabindex="-1"><a class="header-anchor" href="#为什么会慢" aria-hidden="true">#</a> 为什么会慢?</h3><p>SQL 执行过程中出现了两次中间结果，都是全长度的、仅需要一个随机结果，缺经历了不必要的排序（虽然优化过)，调用了很多次 RAND()。</p><h3 id="解决方法-临时优化方法" tabindex="-1"><a class="header-anchor" href="#解决方法-临时优化方法" aria-hidden="true">#</a> 解决方法-临时优化方法</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select max(film_id),min(film_id) into @M,@N from film ;
set @X= floor((@M-@N+1)*rand() +@N);
select title, description from film where film_id &gt;= @X limit 1;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="解决方法-业务方案-推荐" tabindex="-1"><a class="header-anchor" href="#解决方法-业务方案-推荐" aria-hidden="true">#</a> 解决方法-业务方案（推荐）</h3><p>解决方法-业务方案 查询数据表总数 total（总数） total 范围内，随机选取一个数字 r 执行以下 SQL:</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select count(*) from film;
# 业务层进行随机取值，然后在执行相关语句
select title, description from film limit r, 1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="优化联合查询" tabindex="-1"><a class="header-anchor" href="#优化联合查询" aria-hidden="true">#</a> 优化联合查询</h2><h3 id="索引下推-version-5-6" tabindex="-1"><a class="header-anchor" href="#索引下推-version-5-6" aria-hidden="true">#</a> 索引下推（Version&lt;=5.6）</h3><p>用下列方式建表:</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>CREATE TABLE `inventory_3`(
    `inventory_id` MEDIUMINT UNSIGNED NOT NULL AUTO_INCREMENT,
    `film_id` SMALLINT UNSIGNED NOT NULL,
    `store_id` TINYINT UNSIGNED NOT NULL,
    `last_update` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (`inventory_id`),
    KEY `idx_store_id_film_id` (`store_id`, `film_id`)
)ENGINE=INNODB AUTO_INCREMENT=101 DEFAULT CHARSET=utf8;
INSERT INTO inventory_3 SELECT * FROM inventory
#索引下推SELECT
# 先查询的 store_id 结果是乱序的
# 再执行  film_id 去查询  (因为之前已经查询了store_id  就可以根据 film_id 来查询 而不是再去走inventory_id)
SELECT * FROM`inventory_3` WHERE store_id in (1, 2) and film_id = 3;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://cdn.jsdelivr.net/gh/moomhub/notes_images01/images/image-20210916145631423.png" alt="image-20210916145631423"></p><h2 id="索引左侧用法" tabindex="-1"><a class="header-anchor" href="#索引左侧用法" aria-hidden="true">#</a> 索引左侧用法</h2><h3 id="联合索引" tabindex="-1"><a class="header-anchor" href="#联合索引" aria-hidden="true">#</a> 联合索引</h3><p>使用两个或以上字段生成的索引，联合索引也可以加速“最左前缀”的查询联合索引可以代替最左侧字段的单独索引</p><blockquote><p>非常重要： “带头大哥不能死，中间兄弟不能丢。”（必须要全查或者只查左边的值）</p></blockquote><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>参考有：A\B\C 联合索引三个字段，进行`where`查询时

where 查询 A
where 查询 A|B
where 查询 A|B|C
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="字符串前缀索引" tabindex="-1"><a class="header-anchor" href="#字符串前缀索引" aria-hidden="true">#</a> 字符串前缀索引</h3><p>如果需要查询的字段太长导致索引查询也会变慢，如果数据都有某些相同的特性可以使用前缀索引</p><blockquote><p>某些业务场景下可以使用前缀索引（某县城的身份证查询业务） 取邮箱字段的前 6 位</p></blockquote><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>alter table user add index index2(email(6))
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>字符串的前缀索引 如果前缀区分度太小，可以考虑两种变通方法:</p><h4 id="倒序存储" tabindex="-1"><a class="header-anchor" href="#倒序存储" aria-hidden="true">#</a> 倒序存储</h4><p>新建一个 hash_crc 字段代替原本字段进行查询 ，该 hash 字段需要索引</p><p>通过倒序来存储相关字段</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT REVERSE(&#39;http://www.mysql.com&#39;);
#参考实现
select * from table_test where hash_crc = REVERSE(&#39;123123@qq.com&#39;);
#或者业务层实现
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="新增-hash-字段-推荐" tabindex="-1"><a class="header-anchor" href="#新增-hash-字段-推荐" aria-hidden="true">#</a> 新增 hash 字段（推荐）</h4><p>新增 hash crc 字段用来校验相关参数</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT crc32(&#39;http://www.mysql.com&#39;);
SELECT crc64(&#39;http://www.mysql.com&#39;);
#参考实现
select * from table_test where hash_crc = crc32(&#39;178989123123&#39;);
#或者业务层实现
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="字符串-like-只支持右模糊" tabindex="-1"><a class="header-anchor" href="#字符串-like-只支持右模糊" aria-hidden="true">#</a> 字符串 like 只支持右模糊</h3><p>会使索引失效</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>like %关键字% and like %关键字
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>右模糊才可以使用索引</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>like 关键字%
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="is-null-优化" tabindex="-1"><a class="header-anchor" href="#is-null-优化" aria-hidden="true">#</a> IS NULL 优化</h2><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT ename FROM t_emp WHERE comm IS NULL; #不使用索引
SELECT ename FROM t_emp WHERE comm =-1;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="尽量少用-运算符" tabindex="-1"><a class="header-anchor" href="#尽量少用-运算符" aria-hidden="true">#</a> 尽量少用 != 运算符</h2><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT ename FROM t_emp WHERE deptno!=20; #不使用索引
SELECT ename FROM t_emp WHERE deptno&lt;20 AND deptno&gt;20;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="尽量少用-in-和-not-in-运算符" tabindex="-1"><a class="header-anchor" href="#尽量少用-in-和-not-in-运算符" aria-hidden="true">#</a> 尽量少用 IN 和 NOT IN 运算符</h2><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT ename FROM t_emp WHERE deptno IN (20,30); #不使用索引
SELECT ename FROM t_emp WHERE deptno=20
UNION ALL
SELECT ename FROM t_emp WHERE deptno=30;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="在表达式左侧使用运算符和函数都会让索引失效" tabindex="-1"><a class="header-anchor" href="#在表达式左侧使用运算符和函数都会让索引失效" aria-hidden="true">#</a> 在表达式左侧使用运算符和函数都会让索引失效</h2><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>#不使用索引
SELECT ename FROM t_emp WHERE salary*12&gt;=100000;

SELECT ename FROM t_emp WHERE salary&gt;=100000/12;
#不使用索引
SELECT ename FROM t_emp WHERE year(hiredate)&gt;=2000;
SELECT ename FROM t_emp
WHERE hiredate&gt;=&#39;2000-01-01 00:00:00&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="为什么扫描行数非常少" tabindex="-1"><a class="header-anchor" href="#为什么扫描行数非常少" aria-hidden="true">#</a> 为什么扫描行数非常少?</h3><p>MySQL5.6 之前，需要先使用索引查询 store_id in (1,2)再全部回表验证 film_id = 3，MySQL5.6 之后，如果索引中可以判断，直接使用索引过滤。</p><h3 id="松散索引扫描-mysql-8-0-才支持" tabindex="-1"><a class="header-anchor" href="#松散索引扫描-mysql-8-0-才支持" aria-hidden="true">#</a> 松散索引扫描（MySql 8.0 才支持）</h3><p>Mysql 8.0 才支持</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>#全表扫描
SELECT * FROM `inventory_3` WHERE film_id = 3;
#松散索引扫描
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="索引失效-不走索引" tabindex="-1"><a class="header-anchor" href="#索引失效-不走索引" aria-hidden="true">#</a> 索引失效，不走索引</h2><h3 id="字段进行了函数操作" tabindex="-1"><a class="header-anchor" href="#字段进行了函数操作" aria-hidden="true">#</a> 字段进行了函数操作</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT * FROM`inventory` WHERE film_id+1 =100;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="时间函数" tabindex="-1"><a class="header-anchor" href="#时间函数" aria-hidden="true">#</a> 时间函数</h3><p>使用 month()函数后，无法使用索引</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>EXPLAIN SELECT * FROM `rental` WHERE MONTH(rental_date)= 5
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>解决方案：需要去掉 month()函数，换成 between</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT * FROM `rental` WHERE rental_date BETWEEN &#39;2005-5-1&#39; AND &#39;2005-6-1&#39; OR rental_date BETWEEN &#39;2006-5-1&#39;AND &#39;2006-6-1&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="字符串与数字比较" tabindex="-1"><a class="header-anchor" href="#字符串与数字比较" aria-hidden="true">#</a> 字符串与数字比较</h3><p>MySQL 中若出现字符串与数字比较，会将字符串转换为数字。<strong>字符 数字转字符、数字 字符转数字</strong>，也会出现无法通过索引来查找.</p><p>参考</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select * from t1 where f1=6;
#如果t1表中f1字段为varchar类型，则此SQL相当于:
select* from t1 where CAST(f1 AS signed int)=6;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="隐式字符编码转换" tabindex="-1"><a class="header-anchor" href="#隐式字符编码转换" aria-hidden="true">#</a> 隐式字符编码转换</h3><p>MySQL 中,utf8 与 utf8mb4 字段比较时，会把 utf8 转为 utf8mb4 上一页的 SQL 相当于:</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select t2.* from t1, t2 where t1.f1=CONVERT(t2.f1 USING utf8mb4) and t1.f2=6;
#解决方法:将查询条件转换为索引字段的编码
select t2.* from t1, t2 where cONVERT(t1.f1 USING utf8)= t2.f1 and t1.f2=6;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="分页查询优化" tabindex="-1"><a class="header-anchor" href="#分页查询优化" aria-hidden="true">#</a> 分页查询优化</h2><h3 id="偏移量大时-效率低" tabindex="-1"><a class="header-anchor" href="#偏移量大时-效率低" aria-hidden="true">#</a> 偏移量大时，效率低</h3><p>执行顺序</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT film_id, title, description FROM `film` ORDER BY title LIMIT 900,10;
#执行索引
# 1、
SELECT film_id, title, description FROM `film` ORDER BY title;
# 2、
LIMIT 900,10;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="优化-sql" tabindex="-1"><a class="header-anchor" href="#优化-sql" aria-hidden="true">#</a> 优化 SQL</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>得到所需数据的主键
SELECT film_id FROM`film`ORDER BY title LIMIT 900,10;
原表与上面的结果连表，获取最终结果
SELECT f.film_id, f.title, f.description FROM`film`f
INNER JOIN (SELECT film_id FROM `film`ORDER BY title LIMIT 900,10 ) m ON f.film_id = m.film_id;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>排序偏移量大时，会丢弃大量无用数据，导致效率低下，可以采取先索引覆盖，再用最终 ID 回表的方法，优化效率</p><h3 id="要不要使用子查询" tabindex="-1"><a class="header-anchor" href="#要不要使用子查询" aria-hidden="true">#</a> 要不要使用子查询</h3><p>因为 MyBatis 等持久层框架开启了缓存功能，其中一级缓存就会保存子查询的结果，所以可以可放心使用子查询。</p><h4 id="结论" tabindex="-1"><a class="header-anchor" href="#结论" aria-hidden="true">#</a> 结论</h4><p>SQL 控制台不要使用子查询，在持久层框架中则可以使用</p><h4 id="如何代替子查询" tabindex="-1"><a class="header-anchor" href="#如何代替子查询" aria-hidden="true">#</a> 如何代替子查询</h4><p>from 子查询 代替 where 子查询</p><blockquote><p>from 子查询只执行一次</p></blockquote><p>推荐使用：</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select * from temp t
join (temp_1) t_1 on t_1.aa&gt; t.aa;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>不推荐使用</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select * from temp t, temp_1 t_1
where t.aa&gt; t_1.aa ;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/moomhub/Notes/edit/main/docs/database/mysql/Mysql查询优化-语句优化.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页"><!--[--><!--]--> 在 GitHub 上编辑此页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 2208300539@qq.com">MoomHub</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><!----><span class="next"><a href="/database/mysql/Mysql%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96.html" class="" aria-label="数据库优化"><!--[--><!--]--> 数据库优化 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.4a9c1875.js" defer></script>
  </body>
</html>

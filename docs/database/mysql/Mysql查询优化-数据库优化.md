# 数据库优化

## 目录

[TOC]

## 优化Mysql最大连接数

**max_connections**是MySQL最大并发连接数，默认值151

MySQL允许的最大连接数上限是16384

实际连接数是最大连接数的85%较为合适（13926）



## 优化Mysql请求堆栈的大小

back_log是存放执行请求的堆栈大小，默认值是50

一般堆栈大小设置成最大连接数的1/3



## 优化Mysql并发线程数

innodb_thread_concurrency代表并发线程数，默认是0

并发线程数应该设置为CPU核心数的两倍



## 优化Mysql连接超时时间

wait-timeout是超时时间，单位是秒,连接默认超时为8小时，连接长期不用又不销毁，浪费资源



## 优化Mysql数据缓存

innodb_buffer_pool_size是InnoDB的缓存容量，默认是128M

InnoDB缓存的大小可以设置为主机内存的70%~80%



## 优化每页数据量

尽量做到冷热数据分离，减小表的宽度优先选择符合存储需要



## 避免行溢出

把BLOB或是TEXT列分离到单独的扩展表中，禁止在数据库中存储图片，文件等大的二进制数据的最小的数



## 控制B+树高度

尽量控制单表数据量的大小，建议控制在**500万**以内据类型



import{_ as s,o as n,c as a,a as e}from"./app.4a9c1875.js";const t={},l=e(`<h1 id="pxc-\u96C6\u7FA4\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#pxc-\u96C6\u7FA4\u5B89\u88C5" aria-hidden="true">#</a> PXC \u96C6\u7FA4\u5B89\u88C5</h1><blockquote><p>PXC \u662F\u57FA\u4E8E Percona \u800C\u6765\u7684</p><p>PXC \u96C6\u7FA4\u53EA\u652F\u6301 InnoDB \u5F15\u64CE\u53EA\u6709 InnoDB \u5F15\u64CE\u7684\u6570\u636E\u624D\u4F1A\u88AB\u540C\u6B65</p></blockquote><p><strong>PXC \u96C6\u7FA4\u8981\u4F7F\u7528\u56DB\u4E2A\u7AEF\u53E3,\u6240\u4EE5\u9632\u706B\u5899\u8981\u653E\u884C\u8FD9\u4E9B\u7AEF\u53E3\u7AEF\u53E3\u63CF\u8FF0</strong></p><table><thead><tr><th style="text-align:center;">\u7AEF\u53E3</th><th style="text-align:center;">\u63CF\u8FF0</th></tr></thead><tbody><tr><td style="text-align:center;">3306</td><td style="text-align:center;">MySQL \u670D\u52A1\u7AEF\u53E3</td></tr><tr><td style="text-align:center;">4444</td><td style="text-align:center;">\u8BF7\u6C42\u5168\u91CF\u540C\u6B65(SST)\u7AEF\u53E3</td></tr><tr><td style="text-align:center;">4567</td><td style="text-align:center;">\u6570\u636E\u5E93\u8282\u70B9\u4E4B\u95F4\u901A\u4FE1\u7AEF\u53E3</td></tr><tr><td style="text-align:center;">4568</td><td style="text-align:center;">\u8BF7\u6C42\u589E\u91CF\u540C\u6B65(IST)\u7AEF\u53E3</td></tr></tbody></table><h2 id="_1\u3001linux-\u4E3B\u673A\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#_1\u3001linux-\u4E3B\u673A\u5B89\u88C5" aria-hidden="true">#</a> 1\u3001Linux \u4E3B\u673A\u5B89\u88C5</h2><h3 id="_1-\u5220\u9664-mariadb-\u7A0B\u5E8F\u5305" tabindex="-1"><a class="header-anchor" href="#_1-\u5220\u9664-mariadb-\u7A0B\u5E8F\u5305" aria-hidden="true">#</a> 1. \u5220\u9664 MariaDB \u7A0B\u5E8F\u5305</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>yum -y remove mari*
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_2-\u5F00\u653E\u9632\u706B\u5899\u7AEF\u53E3" tabindex="-1"><a class="header-anchor" href="#_2-\u5F00\u653E\u9632\u706B\u5899\u7AEF\u53E3" aria-hidden="true">#</a> 2. \u5F00\u653E\u9632\u706B\u5899\u7AEF\u53E3</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">3306</span>/tcp --permanent
firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">4444</span>/tcp --permanent
firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">4567</span>/tcp --permanent
firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">4568</span>/tcp --permanent
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-\u5173\u95ED-selinux" tabindex="-1"><a class="header-anchor" href="#_3-\u5173\u95ED-selinux" aria-hidden="true">#</a> 3. \u5173\u95ED SELINUX</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">vi</span> /etc/selinux/config
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u628A SELINUX \u5C5E\u6027\u503C\u8BBE\u7F6E\u6210 disabled</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">reboot</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_4-\u79BB\u7EBF\u5B89\u88C5-pxc" tabindex="-1"><a class="header-anchor" href="#_4-\u79BB\u7EBF\u5B89\u88C5-pxc" aria-hidden="true">#</a> 4. \u79BB\u7EBF\u5B89\u88C5 PXC</h3><ul><li><p>\u8FDB\u5165 RPM \u6587\u4EF6\u76EE\u5F55\uFF0C\u6267\u884C\u5B89\u88C5\u547D\u4EE4</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>yum localinstall *.rpm
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>\u53C2\u8003\u7B2C\u4E00\u7AE0\u5185\u5BB9\uFF0C\u4FEE\u6539 MySQL \u914D\u7F6E\u6587\u4EF6\u3001\u521B\u5EFA\u8D26\u6237\u7B49\u64CD\u4F5C</p></li></ul><h3 id="_5-\u521B\u5EFA-pxc-\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#_5-\u521B\u5EFA-pxc-\u96C6\u7FA4" aria-hidden="true">#</a> 5. \u521B\u5EFA PXC \u96C6\u7FA4</h3><ul><li><p>\u505C\u6B62 MySQL \u670D\u52A1</p></li><li><p>\u4FEE\u6539\u6BCF\u4E2A PXC \u8282\u70B9\u7684/etc/my.cnf \u6587\u4EF6\uFF08\u5728\u4E0D\u540C\u8282\u70B9\u4E0A\uFF0C\u6CE8\u610F\u8C03\u6574\u6587\u4EF6\u5185\u5BB9\uFF09</p><div class="language-ini ext-ini line-numbers-mode"><pre class="language-ini"><code><span class="token key attr-name">server-id</span><span class="token punctuation">=</span><span class="token value attr-value">1  #PXC\u96C6\u7FA4\u4E2DMySQL\u5B9E\u4F8B\u7684\u552F\u4E00ID\uFF0C\u4E0D\u80FD\u91CD\u590D\uFF0C\u5FC5\u987B\u662F\u6570\u5B57</span>
<span class="token key attr-name">wsrep_provider</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/lib64/galera3/libgalera_smm.so</span>
<span class="token key attr-name">wsrep_cluster_name</span><span class="token punctuation">=</span><span class="token value attr-value">pxc-cluster  #PXC\u96C6\u7FA4\u7684\u540D\u79F0</span>
<span class="token key attr-name">wsrep_cluster_address</span><span class="token punctuation">=</span><span class="token value attr-value">gcomm://192.168.99.151,192.168.99.159,192.168.99.215</span>
<span class="token key attr-name">wsrep_node_name</span><span class="token punctuation">=</span><span class="token value attr-value">pxc1  #\u5F53\u524D\u8282\u70B9\u7684\u540D\u79F0</span>
<span class="token key attr-name">wsrep_node_address</span><span class="token punctuation">=</span><span class="token value attr-value">192.168.99.151  #\u5F53\u524D\u8282\u70B9\u7684IP</span>
<span class="token key attr-name">wsrep_sst_method</span><span class="token punctuation">=</span><span class="token value attr-value">xtrabackup-v2  #\u540C\u6B65\u65B9\u6CD5\uFF08mysqldump\u3001rsync\u3001xtrabackup\uFF09</span>
<span class="token key attr-name">wsrep_sst_auth</span><span class="token punctuation">=</span> <span class="token value attr-value">admin:Abc_123456  #\u540C\u6B65\u4F7F\u7528\u7684\u5E10\u6237</span>
<span class="token key attr-name">pxc_strict_mode</span><span class="token punctuation">=</span><span class="token value attr-value">ENFORCING  #\u540C\u6B65\u4E25\u5389\u6A21\u5F0F</span>
<span class="token key attr-name">binlog_format</span><span class="token punctuation">=</span><span class="token value attr-value">ROW  #\u57FA\u4E8EROW\u590D\u5236\uFF08\u5B89\u5168\u53EF\u9760\uFF09</span>
<span class="token key attr-name">default_storage_engine</span><span class="token punctuation">=</span><span class="token value attr-value">InnoDB  #\u9ED8\u8BA4\u5F15\u64CE</span>
<span class="token key attr-name">innodb_autoinc_lock_mode</span><span class="token punctuation">=</span><span class="token value attr-value">2  #\u4E3B\u952E\u81EA\u589E\u957F\u4E0D\u9501\u8868</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u4E3B\u8282\u70B9\u7684\u7BA1\u7406\u547D\u4EE4\uFF08\u7B2C\u4E00\u4E2A\u542F\u52A8\u7684 PXC \u8282\u70B9\uFF09</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>systemctl start mysql@bootstrap.service
systemctl stop mysql@bootstrap.service
systemctl restart mysql@bootstrap.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u975E\u4E3B\u8282\u70B9\u7684\u7BA1\u7406\u547D\u4EE4\uFF08\u975E\u7B2C\u4E00\u4E2A\u542F\u52A8\u7684 PXC \u8282\u70B9\uFF09</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">service</span> start mysql
<span class="token function">service</span> stop mysql
<span class="token function">service</span> restart mysql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u67E5\u770B PXC \u96C6\u7FA4\u72B6\u6001\u4FE1\u606F</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>show status like &#39;wsrep_cluster%&#39; ;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><strong>\u6309\u7167\u4E0A\u8FF0\u914D\u7F6E\u65B9\u6CD5\uFF0C\u521B\u5EFA\u4E24\u7EC4 PXC \u96C6\u7FA4</strong></p></li></ul><h3 id="_6-pxc-\u8282\u70B9\u542F\u52A8\u4E0E\u5173\u95ED" tabindex="-1"><a class="header-anchor" href="#_6-pxc-\u8282\u70B9\u542F\u52A8\u4E0E\u5173\u95ED" aria-hidden="true">#</a> 6. PXC \u8282\u70B9\u542F\u52A8\u4E0E\u5173\u95ED</h3><ul><li>\u5982\u679C\u6700\u540E\u5173\u95ED\u7684 PXC \u8282\u70B9\u662F\u5B89\u5168\u9000\u51FA\u7684\uFF0C\u90A3\u4E48\u4E0B\u6B21\u542F\u52A8\u8981\u6700\u5148\u542F\u52A8\u8FD9\u4E2A\u8282\u70B9\uFF0C\u800C\u4E14\u8981\u4EE5\u4E3B\u8282\u70B9\u542F\u52A8</li><li>\u5982\u679C\u6700\u540E\u5173\u95ED\u7684 PXC \u8282\u70B9\u4E0D\u662F\u5B89\u5168\u9000\u51FA\u7684\uFF0C\u90A3\u4E48\u8981\u5148\u4FEE\u6539<code>/var/lib/mysql/grastate.dat</code> \u6587\u4EF6\uFF0C\u628A\u5176\u4E2D\u7684<code>safe_to_bootstrap</code>\u5C5E\u6027\u503C\u8BBE\u7F6E\u4E3A 1\uFF0C\u518D\u5B89\u88C5\u4E3B\u8282\u70B9\u542F\u52A8</li></ul><h2 id="_2\u3001docker-\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#_2\u3001docker-\u5B89\u88C5" aria-hidden="true">#</a> 2\u3001Docker \u5B89\u88C5</h2><h3 id="_1-\u62C9\u53D6\u955C\u50CF" tabindex="-1"><a class="header-anchor" href="#_1-\u62C9\u53D6\u955C\u50CF" aria-hidden="true">#</a> 1.\u62C9\u53D6\u955C\u50CF</h3><p>\u5728 docker \u4E2D\u9009\u62E9\u4F60\u8981\u62C9\u53D6\u7684\u955C\u50CF https://registry.hub.docker.com/r/percona/percona-xtradb-cluster</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull percona/percona-xtradb-cluster:5.7.30-31.43
<span class="token function">docker</span> pull percona/percona-xtradb-cluster:8.0.19-10.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-\u76F4\u63A5\u542F\u52A8\u7248-\u50BB\u74DC\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_2-\u76F4\u63A5\u542F\u52A8\u7248-\u50BB\u74DC\u64CD\u4F5C" aria-hidden="true">#</a> 2.\u76F4\u63A5\u542F\u52A8\u7248\uFF08\u50BB\u74DC\u64CD\u4F5C\uFF09</h3><p>\u540D\u79F0\u89E3\u91CA</p><table><thead><tr><th>\u540D\u79F0</th><th>\u89E3\u91CA</th></tr></thead><tbody><tr><td>MYSQL_ROOT_PASSWORD</td><td>\u6570\u636E\u5E93 root \u5BC6\u7801</td></tr><tr><td>CLUSTER_NAME</td><td>\u96C6\u7FA4\u540D\u79F0</td></tr><tr><td>CLUSTER_JOIN</td><td>\u52A0\u5165\u7684\u8282\u70B9</td></tr></tbody></table><blockquote><p>\u4E00\u5B9A\u8981\u5148\u521B\u5EFA\u5E76\u5F00\u542F\u8282\u70B9 1 \u4E0D\u7136\u4E4B\u540E\u8282\u70B9\u4F1A\u62A5\u9519</p></blockquote><p>\u76F4\u63A5\u6309\u7167\u987A\u5E8F\u8F93\u5165\u5982\u4E0B\u547D\u4EE4</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run -d --name pxc1 <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">CLUSTER_NAME</span><span class="token operator">=</span>pxc-server <span class="token punctuation">\\</span>
-p <span class="token number">3331</span>:3306 <span class="token punctuation">\\</span>
--network mynetwork --ip <span class="token number">172.18</span>.0.11 <span class="token punctuation">\\</span>
percona/percona-xtradb-cluster:5.7.30-31.43

<span class="token function">docker</span> run -d --name pxc2 <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">CLUSTER_NAME</span><span class="token operator">=</span>pxc-server <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">CLUSTER_JOIN</span><span class="token operator">=</span>pxc1 <span class="token punctuation">\\</span>
-p <span class="token number">3322</span>:3306 <span class="token punctuation">\\</span>
--network mynetwork --ip <span class="token number">172.18</span>.0.12 <span class="token punctuation">\\</span>
percona/percona-xtradb-cluster:5.7.30-31.43

<span class="token function">docker</span> run -d --name pxc3 <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">CLUSTER_NAME</span><span class="token operator">=</span>pxc-server <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">CLUSTER_JOIN</span><span class="token operator">=</span>pxc1 <span class="token punctuation">\\</span>
-p <span class="token number">3323</span>:3306 <span class="token punctuation">\\</span>
--network mynetwork --ip <span class="token number">172.18</span>.0.13 <span class="token punctuation">\\</span>
percona/percona-xtradb-cluster:5.7.30-31.43
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-\u6302\u8F7D\u914D\u7F6E\u6587\u4EF6\u7248-\u63A8\u8350-5-7-30-\u7248\u672C" tabindex="-1"><a class="header-anchor" href="#_3-\u6302\u8F7D\u914D\u7F6E\u6587\u4EF6\u7248-\u63A8\u8350-5-7-30-\u7248\u672C" aria-hidden="true">#</a> 3.\u6302\u8F7D\u914D\u7F6E\u6587\u4EF6\u7248\uFF08\u63A8\u8350\uFF095.7 .30 \u7248\u672C</h3><p>\u65B0\u5EFA\u4E09\u4E2A PXC \u7684\u76EE\u5F55\u7528\u4E8E\u5B58\u653E\u76F8\u5173\u7684\u914D\u7F6E\u6587\u4EF6\u548C\u6570\u636E</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u521B\u5EFA\u76F8\u5173\u6587\u4EF6</span>
<span class="token function">mkdir</span> /opt/docker/pxc-server
<span class="token builtin class-name">cd</span> /opt/docker/pxc-server
<span class="token function">mkdir</span> pxc1 pxc2 pxc3
<span class="token function">mkdir</span> pxc1/mysql pxc2/mysql pxc3/mysql
<span class="token comment"># \u521B\u5EFA\u914D\u7F6E\u6587\u4EF6 \u6BCF\u4E00\u4E2A\u90FD\u8981\u4E0D\u4E00\u6837</span>
<span class="token function">vi</span> pxc1/my.cnf
<span class="token function">cp</span> /opt/docker/pxc-server/pxc1/my.cnf /opt/docker/pxc-server/pxc2/my.cnf
<span class="token function">cp</span> /opt/docker/pxc-server/pxc1/my.cnf /opt/docker/pxc-server/pxc3/my.cnf
<span class="token comment"># \u4FEE\u6539\u6587\u4EF6\u5939\u6743\u9650</span>
<span class="token function">chmod</span> <span class="token number">777</span> /opt/docker/pxc-server/*
<span class="token function">chmod</span> <span class="token number">777</span> /opt/docker/pxc-server/pxc1/* /opt/docker/pxc-server/pxc2/* /opt/docker/pxc-server/pxc3/*
<span class="token function">chmod</span> <span class="token number">664</span> /opt/docker/pxc-server/pxc1/conf/my.cnf /opt/docker/pxc-server/pxc2/conf/my.cnf /opt/docker/pxc-server/pxc3/conf/my.cnf

<span class="token function">chmod</span> <span class="token number">664</span> /opt/docker/pxc-server/pxc1/my.cnf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>my.cnf</strong>\u914D\u7F6E\u6587\u4EF6\u5185\u5BB9</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
<span class="token comment"># default_authentication_plugin=mysql_native_password</span>
<span class="token assign-left variable">datadir</span><span class="token operator">=</span>/var/lib/mysql
skip-host-cache
skip-name-resolve
core-file

<span class="token comment"># \u9ED8\u8BA4\u5B57\u7B26\u96C6</span>
character_set_server <span class="token operator">=</span> utf8
bind_address <span class="token operator">=</span> <span class="token number">0.0</span>.0.0

<span class="token assign-left variable">default_storage_engine</span><span class="token operator">=</span>InnoDB
<span class="token assign-left variable">binlog_format</span><span class="token operator">=</span>ROW
skip-host-cache
core-file
<span class="token comment"># \u65E5\u5FD7\u4FDD\u5B58\u5929\u6570</span>
<span class="token assign-left variable">expire_logs_days</span><span class="token operator">=</span><span class="token number">7</span>
<span class="token comment">#Disabling symbolic-links is recommended to porevent assorted security risks</span>
symbolic-links<span class="token operator">=</span><span class="token number">0</span>

innodb_flush_log_at_trx_commit  <span class="token operator">=</span> <span class="token number">0</span>
innodb_flush_method             <span class="token operator">=</span> O_DIRECT
innodb_file_per_table           <span class="token operator">=</span> <span class="token number">1</span>
<span class="token assign-left variable">innodb_autoinc_lock_mode</span><span class="token operator">=</span><span class="token number">2</span>

<span class="token comment">#\u914D\u7F6E\u6587\u4EF6\u4E2DPXC\u76F8\u5173\u5185\u5BB9</span>
server-id<span class="token operator">=</span><span class="token number">1</span> <span class="token comment">#PXC\u96C6\u7FA4\u4E2DMySQL\u5B9E\u4F8B\u7684\u552F\u4E00ID\uFF0C\u4E0D\u80FD\u91CD\u590D\uFF0C\u5FC5\u987B\u662F\u6570\u5B57</span>
<span class="token assign-left variable">wsrep_slave_threads</span><span class="token operator">=</span><span class="token number">2</span>
<span class="token assign-left variable">wsrep_node_incoming_address</span><span class="token operator">=</span><span class="token number">172.18</span>.0.11:3306
<span class="token assign-left variable">wsrep_provider</span><span class="token operator">=</span>/usr/lib64/galera3/libgalera_smm.so
<span class="token assign-left variable">wsrep_cluster_name</span><span class="token operator">=</span>pxc-server <span class="token comment">#PXC\u96C6\u7FA4\u7684\u540D\u79F0</span>
<span class="token assign-left variable">wsrep_cluster_address</span><span class="token operator">=</span>gcomm://172.18.0.11,172.18.0.12,172.18.0.13
<span class="token assign-left variable">wsrep_node_name</span><span class="token operator">=</span>pxc1<span class="token comment">#\u5F53\u524D\u8282\u70B9\u7684\u540D\u79F0</span>
<span class="token assign-left variable">wsrep_node_address</span><span class="token operator">=</span><span class="token number">172.18</span>.0.11<span class="token comment">#\u5F53\u524D\u8282\u70B9\u7684IP</span>
<span class="token assign-left variable">wsrep_sst_method</span><span class="token operator">=</span>xtrabackup-v2<span class="token comment">#\u540C\u6B65\u65B9\u6CD5(mysqldump\u3001rsync\u3001xtrabackup)</span>
<span class="token assign-left variable">wsrep_sst_auth</span><span class="token operator">=</span> root:123456 <span class="token comment">#\u540C\u6B65\u4F7F\u7528\u7684\u5E10\u6237</span>
<span class="token assign-left variable">pxc_strict_mode</span><span class="token operator">=</span>ENFORCING <span class="token comment">#\u540C\u6B65\u4E25\u5389\u6A21\u5F0F</span>
<span class="token assign-left variable">binlog_format</span><span class="token operator">=</span>ROW <span class="token comment">#\u57FA\u4E8EROW\u590D\u5236(\u5B89\u5168\u53EF\u9760)</span>
<span class="token assign-left variable">default_storage_engine</span><span class="token operator">=</span>InnoDB <span class="token comment">#\u9ED8\u8BA4\u5F15\u64CE</span>
<span class="token assign-left variable">innodb_autoinc_lock_mode</span><span class="token operator">=</span><span class="token number">2</span> <span class="token comment">#\u4E3B\u952E\u81EA\u589E\u957F\u4E0D\u9501\u8868</span>
<span class="token comment"># \u8FD9\u4E2A\u53EA\u662F\u5728\u5BFC\u5165\u6570\u636E\u65F6\u4F7F\u7528</span>
<span class="token assign-left variable">innodb_flush_log_at_trx_commit</span><span class="token operator">=</span> <span class="token number">0</span>
<span class="token assign-left variable">innodb_flush_method</span><span class="token operator">=</span> O_DIRECT
<span class="token assign-left variable">innodb_buffer_pool_size</span><span class="token operator">=</span> 200M

<span class="token comment"># \u7981\u7528 ssl mysql  8 \u4E2D\u5F00\u542F</span>
<span class="token comment"># pxc-encrypt-cluster-traffic=OFF</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD0\u884C docker \u5BB9\u5668</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run -d --name pxc1 <span class="token punctuation">\\</span>
-v /opt/docker/pxc-server/pxc1/mysql:/var/lib/mysql <span class="token punctuation">\\</span>
--mount <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/opt/docker/pxc-server/pxc1/my.cnf,dst<span class="token operator">=</span>/etc/my.cnf <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\\</span>
-p <span class="token number">3310</span>:3306 <span class="token punctuation">\\</span>
--privileged<span class="token operator">=</span>true <span class="token punctuation">\\</span>
--network mynetwork --ip <span class="token number">172.18</span>.0.10 <span class="token punctuation">\\</span>
percona/percona-xtradb-cluster:5.7.30-31.43

<span class="token function">docker</span> run -d --name pxc1 <span class="token punctuation">\\</span>
-v /opt/docker/pxc-server/pxc1/mysql:/var/lib/mysql <span class="token punctuation">\\</span>
--mount <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/opt/docker/pxc-server/pxc1/my.cnf,dst<span class="token operator">=</span>/etc/my.cnf <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\\</span>
-p <span class="token number">3311</span>:3306 <span class="token punctuation">\\</span>
--privileged<span class="token operator">=</span>true <span class="token punctuation">\\</span>
--network mynetwork --ip <span class="token number">172.18</span>.0.11 <span class="token punctuation">\\</span>
percona/percona-xtradb-cluster:5.7.30-31.43

<span class="token function">docker</span> run -d --name pxc2 <span class="token punctuation">\\</span>
-v /opt/docker/pxc-server/pxc2/mysql:/var/lib/mysql <span class="token punctuation">\\</span>
--mount <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/opt/docker/pxc-server/pxc2/my.cnf,dst<span class="token operator">=</span>/etc/my.cnf <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\\</span>
-p <span class="token number">3312</span>:3306 <span class="token punctuation">\\</span>
--privileged<span class="token operator">=</span>true <span class="token punctuation">\\</span>
--restart<span class="token operator">=</span>always <span class="token punctuation">\\</span>
--network mynetwork --ip <span class="token number">172.18</span>.0.12 <span class="token punctuation">\\</span>
percona/percona-xtradb-cluster:5.7.30-31.43

<span class="token function">docker</span> run -d --name pxc3 <span class="token punctuation">\\</span>
-v /opt/docker/pxc-server/pxc3/mysql:/var/lib/mysql <span class="token punctuation">\\</span>
--mount <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/opt/docker/pxc-server/pxc3/my.cnf,dst<span class="token operator">=</span>/etc/my.cnf <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\\</span>
-p <span class="token number">3313</span>:3306 <span class="token punctuation">\\</span>
--privileged<span class="token operator">=</span>true <span class="token punctuation">\\</span>
--restart<span class="token operator">=</span>always <span class="token punctuation">\\</span>
--network mynetwork --ip <span class="token number">172.18</span>.0.13 <span class="token punctuation">\\</span>
percona/percona-xtradb-cluster:5.7.30-31.43
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6DFB\u52A0\u5B8C\u6210\u6216\u94FE\u63A5\u6570\u636E\u5E93\u8F93\u5165\u4EE5\u4E0B\u547D\u4EE4 \u67E5\u770B\u662F\u5426\u5B89\u88C5\u6210\u529F</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>show status like &#39;wsrep_cluster%&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>
<span class="token function">docker</span> run -d --name pxc1 <span class="token punctuation">\\</span>
-v /opt/docker/pxc-server/pxc1/mysql:/var/lib/mysql <span class="token punctuation">\\</span>
--mount <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/opt/docker/pxc-server/pxc1/my.cnf,dst<span class="token operator">=</span>/etc/my.cnf <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\\</span>
-p <span class="token number">3311</span>:3306 <span class="token punctuation">\\</span>
--privileged<span class="token operator">=</span>true <span class="token punctuation">\\</span>
--network mynetwork --ip <span class="token number">172.18</span>.0.11 <span class="token punctuation">\\</span>
percona/percona-xtradb-cluster:8.0.19-10.1

<span class="token function">docker</span> run -d --name pxc2 <span class="token punctuation">\\</span>
-v /opt/docker/pxc-server/pxc2/mysql:/var/lib/mysql <span class="token punctuation">\\</span>
--mount <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/opt/docker/pxc-server/pxc2/my.cnf,dst<span class="token operator">=</span>/etc/my.cnf <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\\</span>
-p <span class="token number">3312</span>:3306 <span class="token punctuation">\\</span>
--privileged<span class="token operator">=</span>true <span class="token punctuation">\\</span>
--network mynetwork --ip <span class="token number">172.18</span>.0.12 <span class="token punctuation">\\</span>
percona/percona-xtradb-cluster:8.0.19-10.1

<span class="token function">docker</span> run -d --name pxc3 <span class="token punctuation">\\</span>
-v /opt/docker/pxc-server/pxc3/mysql:/var/lib/mysql <span class="token punctuation">\\</span>
--mount <span class="token assign-left variable">type</span><span class="token operator">=</span>bind,src<span class="token operator">=</span>/opt/docker/pxc-server/pxc3/my.cnf,dst<span class="token operator">=</span>/etc/my.cnf <span class="token punctuation">\\</span>
-e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\\</span>
-p <span class="token number">3313</span>:3306 <span class="token punctuation">\\</span>
--privileged<span class="token operator">=</span>true <span class="token punctuation">\\</span>
--network mynetwork --ip <span class="token number">172.18</span>.0.13 <span class="token punctuation">\\</span>
percona/percona-xtradb-cluster:8.0.19-10.1

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u914D\u7F6E\u6587\u4EF6\u7248</p><p>\u914D\u7F6E\u6587\u4EF6\u4FE1\u606F</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>

<span class="token assign-left variable">default_authentication_plugin</span><span class="token operator">=</span>mysql_native_password
<span class="token assign-left variable">datadir</span><span class="token operator">=</span>/var/lib/mysql
<span class="token assign-left variable">socket</span><span class="token operator">=</span>/tmp/mysql.sock
skip-host-cache
skip-name-resolve
core-file

character_set_server <span class="token operator">=</span> utf8
bind_address <span class="token operator">=</span> <span class="token number">0.0</span>.0.0

<span class="token assign-left variable">default_storage_engine</span><span class="token operator">=</span>InnoDB
<span class="token assign-left variable">binlog_format</span><span class="token operator">=</span>ROW


<span class="token assign-left variable">expire_logs_days</span><span class="token operator">=</span><span class="token number">7</span>
<span class="token comment">#Disabling symbolic-links is recommended to porevent assorted security risks</span>
symbolic-links<span class="token operator">=</span><span class="token number">0</span>

innodb_flush_log_at_trx_commit  <span class="token operator">=</span> <span class="token number">0</span>
innodb_flush_method             <span class="token operator">=</span> O_DIRECT
innodb_file_per_table           <span class="token operator">=</span> <span class="token number">1</span>
<span class="token assign-left variable">innodb_autoinc_lock_mode</span><span class="token operator">=</span><span class="token number">2</span>

<span class="token comment">#\u914D\u7F6E\u6587\u4EF6\u4E2DPXC\u76F8\u5173\u5185\u5BB9</span>
server-id<span class="token operator">=</span><span class="token number">1</span> <span class="token comment">#PXC\u96C6\u7FA4\u4E2DMySQL\u5B9E\u4F8B\u7684\u552F\u4E00ID\uFF0C\u4E0D\u80FD\u91CD\u590D\uFF0C\u5FC5\u987B\u662F\u6570\u5B57</span>
<span class="token assign-left variable">wsrep_slave_threads</span><span class="token operator">=</span><span class="token number">2</span>
<span class="token assign-left variable">wsrep_node_incoming_address</span><span class="token operator">=</span><span class="token number">172.18</span>.0.11:3306
<span class="token assign-left variable">wsrep_provider</span><span class="token operator">=</span>/usr/lib64/galera4/libgalera_smm.so
<span class="token assign-left variable">wsrep_cluster_name</span><span class="token operator">=</span>pxc-server <span class="token comment">#PXC\u96C6\u7FA4\u7684\u540D\u79F0</span>
<span class="token assign-left variable">wsrep_cluster_address</span><span class="token operator">=</span>gcomm://
<span class="token assign-left variable">wsrep_node_name</span><span class="token operator">=</span>test1<span class="token comment">#\u5F53\u524D\u8282\u70B9\u7684\u540D\u79F0</span>
<span class="token assign-left variable">wsrep_node_address</span><span class="token operator">=</span><span class="token number">172.18</span>.0.11<span class="token comment">#\u5F53\u524D\u8282\u70B9\u7684IP</span>
<span class="token assign-left variable">wsrep_sst_method</span><span class="token operator">=</span>xtrabackup-v2<span class="token comment">#\u540C\u6B65\u65B9\u6CD5(mysqldump\u3001rsync\u3001xtrabackup)</span>
<span class="token assign-left variable">pxc_strict_mode</span><span class="token operator">=</span>ENFORCING <span class="token comment">#\u540C\u6B65\u4E25\u5389\u6A21\u5F0F</span>
<span class="token assign-left variable">binlog_format</span><span class="token operator">=</span>ROW <span class="token comment">#\u57FA\u4E8EROW\u590D\u5236(\u5B89\u5168\u53EF\u9760)</span>
<span class="token assign-left variable">default_storage_engine</span><span class="token operator">=</span>InnoDB <span class="token comment">#\u9ED8\u8BA4\u5F15\u64CE</span>
<span class="token assign-left variable">innodb_autoinc_lock_mode</span><span class="token operator">=</span><span class="token number">2</span> <span class="token comment">#\u4E3B\u952E\u81EA\u589E\u957F\u4E0D\u9501\u8868</span>
<span class="token comment"># \u8FD9\u4E2A\u53EA\u662F\u5728\u5BFC\u5165\u6570\u636E\u65F6\u4F7F\u7528</span>
<span class="token assign-left variable">innodb_flush_log_at_trx_commit</span><span class="token operator">=</span> <span class="token number">0</span>
<span class="token assign-left variable">innodb_flush_method</span><span class="token operator">=</span> O_DIRECT
<span class="token assign-left variable">innodb_buffer_pool_size</span><span class="token operator">=</span> 200M

pxc-encrypt-cluster-traffic<span class="token operator">=</span>OFF

<span class="token punctuation">[</span>client<span class="token punctuation">]</span>
<span class="token assign-left variable">socket</span><span class="token operator">=</span>/tmp/mysql.sock

<span class="token punctuation">[</span>sst<span class="token punctuation">]</span>
<span class="token assign-left variable">progress</span><span class="token operator">=</span>/var/lib/mysql/sst_in_progresss
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>PXC \u96C6\u7FA4\u7BA1\u7406</p><p>PXC \u96C6\u7FA4\u4FE1\u606F</p><p>PXC \u96C6\u7FA4\u4FE1\u606F\u53EF\u4EE5\u5206\u4E3A\u4EE5\u4E0B\u51E0\u7C7B:</p><p>\u961F\u5217 \u590D\u5236 \u6D41\u63A7 \u4E8B\u7269 \u72B6\u6001 https://www.percona.com/doc/percona-xtradb-cluster/LATEST/wsrep-status-index.html</p><h2 id="_3\u3001pxc-\u53C2\u6570\u8BF4\u660E" tabindex="-1"><a class="header-anchor" href="#_3\u3001pxc-\u53C2\u6570\u8BF4\u660E" aria-hidden="true">#</a> 3\u3001PXC \u53C2\u6570\u8BF4\u660E</h2><p>PXC \u6570\u636E\u590D\u5236\u76F8\u5173\u7684\u4FE1\u606F</p><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>wsrep_last_applied</td><td>\u540C\u6B65\u5E94\u7528\u6B21\u6570</td></tr><tr><td>wsrep_last_committed</td><td>\u4E8B\u7269\u63D0\u4EA4\u6B21\u6570</td></tr><tr><td>wsrep_replicated</td><td>\u88AB\u5176\u4ED6\u8282\u70B9\u590D\u5236\u7684\u603B\u6570</td></tr><tr><td>wsrep_replicated_bytes</td><td>\u88AB\u5176\u4ED6\u8282\u70B9\u590D\u5236\u7684\u6570\u636E\u603B\u6570</td></tr><tr><td>wsrep_received</td><td>\u4ECE\u5176\u4ED6\u8282\u70B9\u5904\u6536\u5230\u7684\u5199\u5165\u8BF7\u6C42\u603B\u6570</td></tr><tr><td>wsrep_received_bytes</td><td>\u4ECE\u5176\u4ED6\u8282\u70B9\u5904\u6536\u5230\u7684\u540C\u6B65\u6570\u636E\u603B\u6570</td></tr></tbody></table><p>PXC \u961F\u5217\u7684\u76F8\u5173\u4FE1\u606F</p><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><strong>wsrep_local_send_queue</strong></td><td>\u53D1\u9001\u961F\u5217\u7684\u957F\u5EA6</td></tr><tr><td>wsrep_local_send_queue_max</td><td>\u53D1\u9001\u961F\u5217\u7684\u6700\u5927\u957F\u5EA6</td></tr><tr><td>wsrep_local_send_queue_min</td><td>\u53D1\u9001\u961F\u5217\u7684\u6700\u5C0F\u957F\u5EA6</td></tr><tr><td><strong>wsrep_local_send_queue_avg</strong></td><td>\u53D1\u9001\u961F\u5217\u7684\u5E73\u5747\u957F\u5EA6</td></tr><tr><td><strong>wsrep_local_recv_queue</strong></td><td>\u63A5\u6536\u961F\u5217\u7684\u957F\u5EA6</td></tr><tr><td>wsrep_local_recv_queue_max</td><td>\u63A5\u6536\u961F\u5217\u7684\u6700\u5927\u957F\u5EA6</td></tr><tr><td>wsrep_local_recv_queue_min</td><td>\u63A5\u6536\u961F\u5217\u7684\u6700\u5C0F\u957F\u5EA6</td></tr><tr><td><strong>wsrep_local_recv_queue_avg</strong></td><td>\u63A5\u6536\u961F\u5217\u7684\u5E73\u5747\u957F\u5EA6</td></tr></tbody></table><p>\u6D41\u91CF\u63A7\u5236\u7684\u76F8\u5173\u4FE1\u606F</p><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>wsrep_flow_control_paused_ns</td><td>\u6D41\u63A7\u6682\u505C\u72B6\u6001\u4E0B\u82B1\u8D39\u7684\u603B\u65F6\u95F4\uFF08\u7EB3\u79D2)</td></tr><tr><td><strong>wsrep_flow_control_paused</strong></td><td>\u6D41\u91CF\u63A7\u5236\u6682\u505C\u65F6\u95F4\u7684\u5360\u6BD4(0~1)</td></tr><tr><td><strong>wsrep_flow_control_sent</strong></td><td>\u53D1\u9001\u7684\u6D41\u63A7\u6682\u505C\u4E8B\u4EF6\u7684\u6570\u91CF</td></tr><tr><td><strong>wsrep_flow_control_recv</strong></td><td>\u63A5\u6536\u7684\u6D41\u63A7\u6682\u505C\u4E8B\u4EF6\u7684\u6570\u91CF</td></tr><tr><td>wsrep_flow_control_interval</td><td>\u6D41\u91CF\u63A7\u5236\u7684\u4E0B\u9650\u548C\u4E0A\u9650\u3002\u4E0A\u9650\u662F\u961F\u5217\u4E2D\u5141\u8BB8\u7684\u6700\u5927\u8BF7\u6C42\u6570\u3002\u5982\u679C\u961F\u5217\u8FBE\u5230\u4E0A\u9650\uFF0C\u5219\u62D2\u7EDD\u65B0\u7684\u8BF7\u6C42\u3002\u5F53\u5904\u7406\u73B0\u6709\u8BF7\u6C42\u65F6\uFF0C\u961F\u5217\u4F1A\u51CF\u5C11\uFF0C\u2014\u65E6\u5230\u8FBE\u4E0B\u9650\uFF0C\u5C06\u518D\u6B21\u5141\u8BB8\u65B0\u7684\u8BF7\u6C42</td></tr><tr><td><strong>wsrep_flow_control_status</strong></td><td>\u6D41\u91CF\u63A7\u5236\u72B6\u6001</td></tr></tbody></table><p>PXC \u72B6\u6001\u7BA1\u7406</p><p>PXC \u8282\u70B9\u72B6\u6001</p><p><img src="https://cdn.jsdelivr.net/gh/moomhub/notes_images01/images/Fl1VTmzCt7EePHJ.png" alt="image-20200922155642505"></p><p>PXC \u96C6\u7FA4\u72B6\u6001</p><p><img src="https://cdn.jsdelivr.net/gh/moomhub/notes_images01/images/85Z6MenauvrlJtY.png" alt="image-20200922155721122"></p><p>\u8282\u70B9\u4E0E\u96C6\u7FA4\u7684\u76F8\u5173\u4FE1\u606F</p><table><thead><tr><th>\u53C2\u6570</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td>wsrep_local_state_comment</td><td>\u8282\u70B9\u72B6\u6001</td></tr><tr><td>wsrep_cluster_status</td><td>\u96C6\u7FA4\u72B6\u6001(PRIMARY\uFF08\u6B63\u5E38\u72B6\u6001\uFF09\u3001NON_PRIMARY\uFF08\u8111\u88C2\uFF09\u3001Disconnected\uFF08\u672A\u8FDE\u63A5\uFF09)</td></tr><tr><td>wsrep_connected</td><td>\u8282\u70B9\u662F\u5426\u8FDE\u63A5\u5230\u96C6\u7FA4</td></tr><tr><td>wsrep_ready</td><td>\u96C6\u7FA4\u662F\u5426\u6B63\u5E38\u5DE5\u4F5C</td></tr><tr><td>wsrep_cluster_size</td><td>\u8282\u70B9\u6570\u91CF</td></tr><tr><td>wsrep_desync_count</td><td>\u5EF6\u65F6\u8282\u70B9\u6570\u91CF</td></tr><tr><td>wsrep_incoming_addresses</td><td>\u96C6\u7FA4\u8282\u70B9 IP \u5730\u5740</td></tr></tbody></table><p>\u4E8B\u52A1\u7684\u76F8\u5173\u4FE1\u606F</p><table><thead><tr><th>\u53C2\u6570</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td>wsrep_cert_deps_distance</td><td>\u4E8B\u52A1\u6267\u884C\u5E76\u53D1\u6570</td></tr><tr><td>wsrep_apply_oooe</td><td>\u63A5\u6536\u961F\u5217\u4E2D\u4E8B\u52A1\u7684\u5360\u6BD4</td></tr><tr><td>wsrep_apply_oool</td><td>\u63A5\u6536\u961F\u5217\u4E2D\u4E8B\u52A1\u4E71\u5E8F\u6267\u884C\u7684\u9891\u7387</td></tr><tr><td>wsrep_apply_window</td><td>\u63A5\u6536\u961F\u5217\u4E2D\u4E8B\u52A1\u7684\u5E73\u5747\u6570\u91CF</td></tr><tr><td>wsrep_commit_oooe</td><td>\u53D1\u9001\u961F\u5217\u4E2D\u4E8B\u52A1\u7684\u5360\u6BD4</td></tr><tr><td>wsrep_commit_oool</td><td>\u65E0\u4EFB\u4F55\u610F\u4E49(\u4E0D\u5B58\u5728\u672C\u5730\u4E71\u5E8F\u63D0\u4EA4)</td></tr><tr><td>wsrep_commit_window</td><td>\u53D1\u9001\u961F\u5217\u4E2D\u4E8B\u52A1\u7684\u5E73\u5747\u6570\u91CF</td></tr></tbody></table><h2 id="_4\u3001pxc-\u8282\u70B9\u4E0A\u7EBF\u548C\u4E0B\u7EBF\u64CD\u4F5C-\u5B89\u88C5\u73AF\u5883\u4E0B" tabindex="-1"><a class="header-anchor" href="#_4\u3001pxc-\u8282\u70B9\u4E0A\u7EBF\u548C\u4E0B\u7EBF\u64CD\u4F5C-\u5B89\u88C5\u73AF\u5883\u4E0B" aria-hidden="true">#</a> 4\u3001PXC \u8282\u70B9\u4E0A\u7EBF\u548C\u4E0B\u7EBF\u64CD\u4F5C\uFF08\u5B89\u88C5\u73AF\u5883\u4E0B\uFF09</h2><p>\u5982\u679C PXC \u8282\u70B9\u90FD\u662F\u5B89\u5168\u9000\u51FA\u7684\uFF0C\u5148\u8981\u542F\u52A8\u6700\u540E\u9000\u51FA\u7684\u8282\u70B9</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u6700\u540E\u5173\u95ED\u7684\u8282\u70B9\u5148\u542F\u52A8</span>
systemctl start mysql@bootstrap.service
<span class="token comment"># \u67E5\u770B\u8282\u70B9\u662F\u5426\u662F\u6700\u540E\u4E00\u4E2A\u8282\u70B9  pxc\u7684\u5B89\u88C5\u76EE\u5F55</span>
<span class="token function">cat</span> /var/lib/mysql/grastate.dat


<span class="token comment">#  safe_to_bootstrap(\u9ED8\u8BA4\u662F0,\u4E3A1\u5219\u4EE3\u8868\u662F\u6700\u540E\u4E00\u4E2A\u8282\u70B9\u7ED3\u675F\u7684\uFF09</span>

safe_to_bootstrap: <span class="token number">1</span> \u8BBE\u7F6E\u4E3A1 <span class="token punctuation">(</span>\u9ED8\u8BA4\u662F0\uFF09
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5\u3001mysql-\u5E38\u7528\u7684\u4E2D\u95F4\u4EF6" tabindex="-1"><a class="header-anchor" href="#_5\u3001mysql-\u5E38\u7528\u7684\u4E2D\u95F4\u4EF6" aria-hidden="true">#</a> 5\u3001Mysql \u5E38\u7528\u7684\u4E2D\u95F4\u4EF6</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>MyCat \uFF08\u63A8\u8350\uFF09
Atlas
OneProxy
Proxy SQL
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,67),p=[l];function i(r,c){return n(),a("div",null,p)}var d=s(t,[["render",i],["__file","PXC\u96C6\u7FA4\u4E3B\u673A\u5B89\u88C5.html.vue"]]);export{d as default};
